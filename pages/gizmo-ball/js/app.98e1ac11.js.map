{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?7e02","webpack:///./src/components/modules/instruction/Instruction.vue?fa6c","webpack:///./src/views/Home.vue?d922","webpack:///./src/components/modules/ModeZone.vue?71cd","webpack:///./src/components/modules/ToolZone.vue?4a74","webpack:///./src/components/modules/ItemZone.vue?4e30","webpack:///./src/components/base/ItemImage.vue?bc05","webpack:///./src/core/physics/geometry.ts","webpack:///./src/App.vue?05a6","webpack:///./src/views/Home.vue?d20d","webpack:///./src/components/modules/GamePanel.vue?9b32","webpack:///./src/components/base/ItemImage.vue?81df","webpack:///./src/core/physics/vector.ts","webpack:///./src/core/physics/kinematics.ts","webpack:///./src/core/physics/collider.ts","webpack:///./src/core/mapitems/map-item.ts","webpack:///./src/core/mapitems/ball.ts","webpack:///./src/core/constants/gizmo.ts","webpack:///./src/store/module1.ts","webpack:///./src/store/index.ts","webpack:///./src/core/common/index.ts","webpack:///./src/components/base/ItemImage.vue?e874","webpack:///./src/components/base/ItemImage.vue?c9fd","webpack:///./src/components/base/ItemImage.vue?ae6d","webpack:///./src/core/mapitems/polygon.ts","webpack:///./src/core/mapitems/square.ts","webpack:///./src/core/mapitems/absorber.ts","webpack:///./src/core/mapitems/baffle.ts","webpack:///./src/core/mapitems/border-map-item.ts","webpack:///./src/core/mapitems/circle.ts","webpack:///./src/core/mapitems/pipe.ts","webpack:///./src/core/mapitems/pipe-turned.ts","webpack:///./src/core/mapitems/triangle.ts","webpack:///./src/core/constants/index.ts","webpack:///./src/core/controller/Controller.ts","webpack:///./src/components/modules/GamePanel.vue?43ea","webpack:///./src/components/modules/GamePanel.vue?5efd","webpack:///./src/components/modules/GamePanel.vue?60d9","webpack:///./src/components/modules/ItemZone.vue?4986","webpack:///./src/components/modules/ItemZone.vue?98f4","webpack:///./src/components/modules/ItemZone.vue?d515","webpack:///./src/components/modules/ItemZone.vue?ee85","webpack:///./src/components/modules/ToolZone.vue?9bd7","webpack:///./src/components/modules/ToolZone.vue?f018","webpack:///./src/components/modules/ToolZone.vue?1306","webpack:///./src/components/modules/ToolZone.vue?a810","webpack:///./src/components/modules/ModeZone.vue?6b03","webpack:///./src/components/modules/ModeZone.vue?305b","webpack:///./src/components/modules/ModeZone.vue?dfab","webpack:///./src/components/modules/ModeZone.vue?1534","webpack:///./src/components/modules/instruction/Instruction.vue?0539","webpack:///./src/components/modules/instruction/Instruction.vue?99cd","webpack:///./src/views/Home.vue?42b8","webpack:///./src/views/Home.vue?2d60","webpack:///./src/views/Home.vue?c853","webpack:///./src/views/TSViews.ts","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/main.ts","webpack:///./src/components/modules/GamePanel.vue?a811"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Direction","_vm","this","_h","$createElement","_c","_self","ref","attrs","staticRenderFns","staticClass","staticStyle","on","$event","onPanelClick","onDrop","preventDefault","onDragover","_l","item","index","currentItemId","id","nativeOn","stopPropagation","onImgClick","class","cssClass","style","position","zindex","rotation","imgURL","width","height","imageDraggable","onDragstart","onDragend","x","y","v","Vector2D","equals","copy","dot","projection","axis","vectorProjection","angle","as","vectorRotate","center","pointRotate","direction","clone","mult","radius","reflect","normalVector","unitization","v1","v2","Math","sqrt","ZERO","Error","acos","a","cos","sin","special","difference","add","component","vectors","sum","forEach","vertex","polygon","p1","p2","point","abs","Line","directionVector","RIGHT_ANGLE","PI","RIGHT_ANGLE_REVERSE","massPoint","move","Physical","tick","setVelocity","reflet","m1","m2","reflectLine","newV1","newV2","unitVector","pipeAcc","negate","gravity","_a","_v","_p","_accRecord","Map","changeVelocity","accType","set","_rotation","Up","_zoom","_position","translate","times","rotate","zoom","zoomTo","_vertexes","_edges","map","array","zoomCenter","crashable","PolygonCollider","edges","axes","polygonCollidesWithCircle","edge","separationOnAxes","projection1","project","projection2","scalars","vertexes","min","max","refletLine","ballPos","outPointProjectionOnEdge","surfaceVelocityReflect","closestPoint","getPolygonPointClosestToCircle","average","circle","undefined","borderAxis1","borderAxis2","_radius","dotProduct","CircleCollider","distance","collider","MapItem","currentID","console","log","collisible","crashDetect","crashHandle","gridScale","vertical","horizontal","pipeID","Ball","perfectElasticCollision","Name","imageUrl","isViewItem","obj","typeValue","gridLength","gridLineLength","sampleItem","img","selectItem","ballItem","absorberItem","triangleItem","circleItem","squareItem","pipeItem","pipeTurnedItem","baffleAlphaItem","baffleBetaItem","itemMap","absorber","ball","pipe","select","square","triangle","border","Gizmo","sampleItems","itemss","getViewItemByType","state","useLightTheme","currentMode","currentState","draggingItem","draggingItemOffset","toolZoneCurrentItem","panelCurrentItem","mutations","changeTheme","useLight","theme","document","getElementById","setAttribute","changeMode","changeState","changeDraggingItem","changeDraggingItemOffset","changeToolZoneCurrentItem","changePanelCurrentItem","actions","use","module1","store","rootActionContext","moduleActionContext","isRotatable","isZoomable","defaultSize","event","commit","offsetX","offsetY","selected","base","SquareMapItem","getInstance","handleAbsorb","AbsorberMapItem","imageURL","offset","BaffleMapItem","BaffleAlphaMapItem","BaffleBetaMapItem","borders","verticalMax","maxGridCount","horizontalMax","CircleMapItem","crashLine","lineCenter","ballCenter","change","setAcceleration","PipeMapItem","entryAxis1","directionRotate","entryAxis2","PipeTurnedMapItem","TriangleMapItem","mapItems","balls","alphaBaffles","betaBaffles","savedJSONString","mapItemsToJSON","mapItem","handleAddItem","items","clearAll","content","readFromJSON","loadMapItemsFromItems","jsonItems","JSON","parse","Array","jsonItem","createFromJSON","from","to","element","mapitem","newPosition","oldPosition","collidesWithOthers","delete","kv","timer","setInterval","clearInterval","clear","loadMapItemsFromJSON","mapItemJSONs","mapItemJSON","stringify","movement","baffle","controller","Controller","maxXY","$refs","getBoundingClientRect","gridX","left","gridY","top","dataTransfer","dropEffect","clientX","clientY","formatPosition","createMapItem","handleDraggingItem","options","cellLength","round","floor","components","ItemImage","rowIndex","colIndex","directives","rawName","expression","domProps","_q","currentItem","val","oldVal","available","remove","zoomin","zoomout","handleRotate","handleDeleteItem","handleZoomIn","handleZoomOut","_e","changeToLayoutMode","changeToPlayMode","controllImg","pause","continue","stopPlaying","startPlaying","_m","script","GamePanel","ItemZone","ToolZone","ModeZone","Instruction","onkeydown","e","k","keyMap","has","onkeyup","handleBaffleMove","bindKey","app","innerHeight","innerWidth","Home","config","productionTip","render","h","App","$mount"],"mappings":"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","file":"js/app.98e1ac11.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/pages/gizmo-ball/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Instruction.vue?vue&type=style&index=0&id=4a5f8f2e&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=style&index=0&id=53f68fe2&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModeZone.vue?vue&type=style&index=0&id=180a421e&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ToolZone.vue?vue&type=style&index=0&id=08d92c8a&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemZone.vue?vue&type=style&index=0&id=3e798ab6&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemImage.vue?vue&type=style&index=0&id=92cbf116&scoped=true&lang=css&\"","import { Vector2D } from \".\";\r\n\r\nexport enum Direction {\r\n  Up,\r\n  Right,\r\n  Down,\r\n  Left\r\n}\r\nexport class Line {\r\n  /**\r\n   * 直线方向向量\r\n   */\r\n  get directionVector(): Vector2D {\r\n    return Vector2D.difference(this.p1, this.p2);\r\n  }\r\n\r\n  /**\r\n   * 直线法向量,在方向向量右侧:原↖法↗\r\n   */\r\n  get normalVector(): Vector2D {\r\n    return this.directionVector.normalVector;\r\n  }\r\n  constructor(public readonly p1: Vector2D, public readonly p2: Vector2D) {\r\n    if (p1.equals(p2)) {\r\n      throw new Error(\"Points cannot be the same!\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 点到直线距离\r\n   */\r\n  public distance(point: Vector2D): number {\r\n    const v1: Vector2D = Vector2D.difference(point, this.p1);\r\n    const n: Vector2D = this.normalVector;\r\n    return Math.abs(v1.projection(n));\r\n  }\r\n\r\n  /**\r\n   * 返回自身复制\r\n   */\r\n  public clone(): Line {\r\n    return new Line(this.p1.clone(), this.p2.clone());\r\n  }\r\n}\r\n\r\nexport class Angle {\r\n  constructor(\r\n    public readonly special: \"\" | \"right-angle\" | \"right-angle-reverse\",\r\n    public readonly value: number\r\n  ) {}\r\n  public static readonly RIGHT_ANGLE: Angle = new Angle(\r\n    \"right-angle\",\r\n    Math.PI / 2\r\n  );\r\n  public static readonly RIGHT_ANGLE_REVERSE: Angle = new Angle(\r\n    \"right-angle-reverse\",\r\n    0 - Math.PI / 2\r\n  );\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"app\",attrs:{\"id\":\"app\"}},[_c('Home')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home\"},[_c('div',{staticClass:\"main test-border\"},[_c('GamePanel')],1),_c('div',{staticClass:\"right-side test-border\"},[_c('div',{staticClass:\"right-top test-border\"},[_c('ItemZone')],1),_c('div',{staticClass:\"right-middle test-border\"},[_c('ToolZone')],1),_c('div',{staticClass:\"right-bottom test-border\"},[_c('ModeZone')],1)]),_c('div',{staticClass:\"instruction\"},[_c('Instruction')],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"game-panel\"},[_c('div',{ref:\"game-grid\",staticClass:\"game-grid\",staticStyle:{\"background-image\":\"url(img/grid.png)\"},on:{\"click\":function($event){return _vm.onPanelClick()},\"drop\":_vm.onDrop,\"dragover\":function($event){$event.preventDefault();return _vm.onDragover($event)},\"dragenter\":function($event){$event.preventDefault();}}},_vm._l((_vm.items),function(item,index){return _c('ItemImage',{key:index,attrs:{\"item\":item,\"selected\":_vm.currentItemId === item.id},nativeOn:{\"click\":function($event){$event.stopPropagation();return _vm.onImgClick(item)}}})}),1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('img',{ref:\"img\",class:_vm.cssClass,style:((\"position: absolute;top:\" + (_vm.item.position.y) + \"px;left:\" + (_vm.item.position.x) + \"px;z-index:\" + _vm.zindex + \";transform: rotate(\" + _vm.rotation + \"deg)\")),attrs:{\"src\":_vm.item.imgURL,\"width\":(_vm.width + \"px\"),\"height\":(_vm.height + \"px\"),\"draggable\":_vm.imageDraggable},on:{\"dragstart\":function($event){return _vm.onDragstart($event)},\"dragend\":function($event){return _vm.onDragend()}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { Angle } from \".\";\r\n\r\nexport class Vector2D {\r\n  constructor(public x: number, public y: number) {}\r\n\r\n  /**\r\n   * 返回自身相等于v的判断\r\n   */\r\n  public equals(v: Vector2D): boolean {\r\n    return Vector2D.equals(this, v);\r\n  }\r\n\r\n  /**\r\n   * 返回自身的复制\r\n   */\r\n  public clone(): Vector2D {\r\n    return Vector2D.copy(this);\r\n  }\r\n\r\n  /**\r\n   * 自身加上向量v,返回自身\r\n   */\r\n  public add(v: Vector2D): Vector2D {\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 重新赋值为v/拷贝v的值,返回自身\r\n   */\r\n  public as(v: Vector2D): Vector2D {\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 自乘实数n,返回自身\r\n   */\r\n  public mult(n: number): Vector2D {\r\n    this.x *= n;\r\n    this.y *= n;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 自身与v的数量积/点积\r\n   */\r\n  public dot(v: Vector2D): number {\r\n    return Vector2D.dot(this, v);\r\n  }\r\n\r\n  /**\r\n   * 自身模长\r\n   */\r\n  get radius(): number {\r\n    return Vector2D.radius(this);\r\n  }\r\n\r\n  /**\r\n   * 自身法向量,返回新向量,在向量左侧:法↖原↗\r\n   */\r\n  get normalVector(): Vector2D {\r\n    return Vector2D.normalVector(this);\r\n  }\r\n\r\n  /**\r\n   * 与自身同向的单位向量,返回新向量\r\n   */\r\n  get unitVector(): Vector2D {\r\n    return Vector2D.unitization(this);\r\n  }\r\n\r\n  /**\r\n   * 计算自身在v上的投影值\r\n   */\r\n  public projection(v: Vector2D): number {\r\n    return Vector2D.projection(this, v);\r\n  }\r\n\r\n  /**\r\n   * 自身在轴axis上的分量,返回新向量\r\n   */\r\n  public component(axis: Vector2D): Vector2D {\r\n    return Vector2D.vectorProjection(this, axis);\r\n  }\r\n\r\n  /**\r\n   * 自身旋转一个角度angle,返回自身\r\n   */\r\n  public vectorRotate(angle: Angle): Vector2D {\r\n    return this.as(Vector2D.vectorRotate(this, angle));\r\n  }\r\n\r\n  /**\r\n   * 自身视作点,让自身并绕中心点center旋转一个角度angle,返回自身\r\n   */\r\n  public pointRotate(center: Vector2D, angle: Angle): Vector2D {\r\n    return this.as(Vector2D.pointRotate(this, center, angle));\r\n  }\r\n\r\n  /**\r\n   * 自身旋转到与direction一致的方向，返回自身\r\n   * @param direction 目标方向向量\r\n   */\r\n  public directionRotate(direction: Vector2D): Vector2D {\r\n    return this.as(direction.clone().mult(this.radius / direction.radius));\r\n  }\r\n\r\n  /**\r\n   * 自身在axis向量为法线的平面进行反射,返回自身\r\n   * @param axis 反射面法线\r\n   */\r\n  public reflet(axis: Vector2D): Vector2D {\r\n    return this.as(Vector2D.reflect(this, axis));\r\n  }\r\n\r\n  /**\r\n   * 向量加法\r\n   */\r\n  public static add(v1: Vector2D, v2: Vector2D): Vector2D {\r\n    return new Vector2D(v1.x + v2.x, v1.y + v2.y);\r\n  }\r\n\r\n  /**\r\n   * 向量减法\r\n   */\r\n  public static difference(v1: Vector2D, v2: Vector2D): Vector2D {\r\n    return new Vector2D(v1.x - v2.x, v1.y - v2.y);\r\n  }\r\n\r\n  /**\r\n   * 向量取反\r\n   */\r\n  public static negate(v: Vector2D): Vector2D {\r\n    return new Vector2D(-v.x, -v.y);\r\n  }\r\n\r\n  /**\r\n   * 向量数乘计算\r\n   */\r\n  public static mult(v: Vector2D, n: number): Vector2D {\r\n    return new Vector2D(v.x * n, v.y * n);\r\n  }\r\n\r\n  /**\r\n   * 向量点积计算\r\n   */\r\n  public static dot(v1: Vector2D, v2: Vector2D): number {\r\n    return v1.x * v2.x + v1.y * v2.y;\r\n  }\r\n\r\n  /**\r\n   * 向量模长计算\r\n   */\r\n  public static radius(v: Vector2D): number {\r\n    return Math.sqrt(Vector2D.dot(v, v));\r\n  }\r\n\r\n  /**\r\n   * 向量单位化\r\n   */\r\n  public static unitization(v: Vector2D): Vector2D {\r\n    if (v.equals(Vector2D.ZERO)) {\r\n      throw new Error(\"cannot get unitization of zero vector\");\r\n    }\r\n    return v.clone().mult(1 / v.radius);\r\n  }\r\n\r\n  /**\r\n   * 向量投影计算\r\n   */\r\n  public static projection(v1: Vector2D, v2: Vector2D): number {\r\n    return Vector2D.dot(v1, v2) / v2.radius;\r\n  }\r\n\r\n  /**\r\n   * 向量投影分量计算\r\n   */\r\n  public static vectorProjection(v: Vector2D, axis: Vector2D): Vector2D {\r\n    return axis.clone().mult(v.dot(axis) / axis.dot(axis));\r\n  }\r\n\r\n  /**\r\n   * 向量夹角计算\r\n   */\r\n  public static angle(v1: Vector2D, v2: Vector2D): number {\r\n    return Math.acos(Vector2D.dot(v1, v2) / (v1.radius * v2.radius));\r\n  }\r\n\r\n  /**\r\n   * 拷贝向量\r\n   */\r\n  public static copy(v: Vector2D): Vector2D {\r\n    return new Vector2D(v.x, v.y);\r\n  }\r\n\r\n  /**\r\n   * 零向量\r\n   */\r\n  public static get ZERO(): Vector2D {\r\n    return new Vector2D(0, 0);\r\n  }\r\n\r\n  /**\r\n   * 向量相等判定\r\n   */\r\n  public static equals(v1: Vector2D, v2: Vector2D): boolean {\r\n    return v1.x === v2.x && v1.y === v2.y;\r\n  }\r\n\r\n  /**\r\n   * 法向量计算,在向量左侧:法↖原↗\r\n   */\r\n  public static normalVector(v: Vector2D): Vector2D {\r\n    return new Vector2D(v.y, -v.x);\r\n  }\r\n\r\n  /**\r\n   * 向量旋转计算\r\n   */\r\n  public static vectorRotate(v: Vector2D, angle: Angle): Vector2D {\r\n    const a: number = angle.value;\r\n    const cos: number = Math.cos(a),\r\n      sin: number = Math.sin(a);\r\n    switch (angle.special) {\r\n      case \"right-angle\":\r\n        return new Vector2D(-v.y, v.x);\r\n      case \"right-angle-reverse\":\r\n        return new Vector2D(v.y, -v.x);\r\n      case \"\":\r\n        return new Vector2D(v.x * cos - v.y * sin, v.y * cos + v.x * sin);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 点绕点旋转计算\r\n   * @param p 被旋转的点\r\n   * @param center 旋转中心\r\n   * @param angle 旋转角度\r\n   */\r\n  public static pointRotate(\r\n    p: Vector2D,\r\n    center: Vector2D,\r\n    angle: Angle\r\n  ): Vector2D {\r\n    return Vector2D.difference(p, center)\r\n      .vectorRotate(angle)\r\n      .add(center);\r\n  }\r\n\r\n  /**\r\n   * 向量反射\r\n   * @param v 入射向量\r\n   * @param axis 法线轴向量\r\n   */\r\n  public static reflect(v: Vector2D, axis: Vector2D): Vector2D {\r\n    return v\r\n      .component(axis)\r\n      .mult(-2)\r\n      .add(v);\r\n  }\r\n\r\n  /**\r\n   * 向量求和\r\n   * @param vectors 向量迭代器\r\n   */\r\n  public static sum(vectors: Vector2D[] | Map<any, Vector2D>): Vector2D {\r\n    const sum: Vector2D = Vector2D.ZERO;\r\n    vectors.forEach((vertex: Vector2D): void => {\r\n      sum.add(vertex);\r\n    });\r\n    return sum;\r\n  }\r\n\r\n  public static average(vectors: Vector2D[]) {\r\n    if (vectors.length) {\r\n      return Vector2D.sum(vectors).mult(1 / vectors.length);\r\n    }\r\n    return Vector2D.ZERO;\r\n  }\r\n\r\n  /**\r\n   * 重心\r\n   * @param polygon 多边形\r\n   */\r\n  public static center(polygon: Vector2D[]): Vector2D {\r\n    return Vector2D.sum(polygon).mult(1 / polygon.length);\r\n  }\r\n}\r\n","import { Vector2D } from \".\";\r\n\r\n/**\r\n * `gravity` 重力加速度\r\n *\r\n * `pipe` 管道加速度\r\n *\r\n * `centripetal` 向心加速度\r\n */\r\ntype AccelerationType = \"gravity\" | \"pipe\" | \"centripetal\";\r\n\r\nexport class Physical {\r\n  public static get gravity(): Vector2D {\r\n    return new Vector2D(0, 15);\r\n  }\r\n  public static readonly tick: number = 0.025;\r\n  public static readonly pipeAcc: Vector2D = Vector2D.negate(Physical.gravity);\r\n\r\n  /**\r\n   * 表面反弹\r\n   * @param massPoint 质点\r\n   * @param axis 反弹面法向量，指向反弹面的外侧\r\n   */\r\n  public static surfaceVelocityReflect(\r\n    massPoint: MassPoint,\r\n    axis: Vector2D\r\n  ): void {\r\n    const v: Vector2D = massPoint.v;\r\n    if (v.dot(axis) < 0) {\r\n      massPoint.move(-Physical.tick);\r\n      massPoint.setVelocity(massPoint.v.reflet(axis));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 两质点完全弹性碰撞\r\n   * @param m1 质点1\r\n   * @param m2 质点2\r\n   */\r\n  public static perfectElasticCollision(m1: MassPoint, m2: MassPoint): void {\r\n    const v1: Vector2D = m1.v,\r\n      v2: Vector2D = m2.v,\r\n      axis: Vector2D = Vector2D.difference(m2.p, m1.p),\r\n      reflectLine: Vector2D = axis.normalVector;\r\n    if (axis.dot(v1) > 0) {\r\n      // 轴向连线分量交换\r\n      const newV1: Vector2D = v2.component(axis).add(v1.component(reflectLine));\r\n      const newV2: Vector2D = v1.component(axis).add(v2.component(reflectLine));\r\n      m1.setVelocity(newV1);\r\n      m2.setVelocity(newV2);\r\n    }\r\n  }\r\n\r\n  public static centripetalAcceleration(\r\n    massPoint: MassPoint,\r\n    radius: number,\r\n    center: Vector2D\r\n  ): Vector2D {\r\n    const v: Vector2D = massPoint.v;\r\n    const value: number = v.dot(v) / radius;\r\n    return Vector2D.difference(center, massPoint.p).unitVector.mult(value);\r\n  }\r\n}\r\n\r\nexport class MassPoint {\r\n  private _p: Vector2D;\r\n  private _v: Vector2D;\r\n  private _a: Vector2D;\r\n  private _accRecord: Map<AccelerationType, Vector2D>;\r\n  constructor() {\r\n    this._a = new Vector2D(0, 0);\r\n    this._v = new Vector2D(0, 0);\r\n    this._p = new Vector2D(0, 0);\r\n    this._accRecord = new Map<AccelerationType, Vector2D>([\r\n      [\"gravity\", Physical.gravity],\r\n      [\"centripetal\", new Vector2D(0, 0)],\r\n      [\"pipe\", new Vector2D(0, 0)]\r\n    ]);\r\n  }\r\n  get p(): Vector2D {\r\n    return Vector2D.copy(this._p);\r\n  }\r\n  get v(): Vector2D {\r\n    return Vector2D.copy(this._v);\r\n  }\r\n  get a(): Vector2D {\r\n    return Vector2D.copy(this._a);\r\n  }\r\n\r\n  public tick(): void {\r\n    this.changeVelocity();\r\n    this.move();\r\n  }\r\n\r\n  /**\r\n   * 质点传送\r\n   * @param p 目标位置\r\n   */\r\n  public translate(p: Vector2D): MassPoint {\r\n    this._p = p.clone();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 匀速移动\r\n   * @param t 极短时间\r\n   */\r\n  public move(t: number = Physical.tick): MassPoint {\r\n    this._p.add(Vector2D.mult(this._v, t));\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 按时间改变速度\r\n   * @param t 极短的时间\r\n   */\r\n  public changeVelocity(t: number = Physical.tick): MassPoint {\r\n    this._v.add(Vector2D.mult(this._a, t));\r\n    if (this._v.radius >= 200) {\r\n      this._v.mult(200 / this._v.radius);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置速度\r\n   * @param v 速度\r\n   */\r\n  public setVelocity(v: Vector2D): MassPoint {\r\n    this._v.as(v);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 增加速度\r\n   * @param v 速度变化量\r\n   */\r\n  public addVelocity(v: Vector2D): MassPoint {\r\n    this._v.add(v);\r\n    return this;\r\n  }\r\n\r\n  // /**\r\n  //  * 增加加速度\r\n  //  * @param a 加速度\r\n  //  */\r\n  // public addAcceleration(a: Vector2D):MassPoint {\r\n  //   this._a.add(a);\r\n  //   return this;\r\n  // }\r\n\r\n  /**\r\n   * 设置指定类型的加速度\r\n   * @param accType 加速度类型\r\n   * @param a 加速度值\r\n   */\r\n  public setAcceleration(accType: AccelerationType, a: Vector2D): MassPoint {\r\n    this._accRecord.set(accType, a);\r\n    const v = Vector2D.sum(this._accRecord);\r\n    this._a = v;\r\n    return this;\r\n  }\r\n\r\n  // /**\r\n  //  * 设置加速度\r\n  //  * @param a 加速度\r\n  //  */\r\n  // public setAccelerationT(a: Vector2D):MassPoint {\r\n  //   this._a.as(a);\r\n  //   return this;\r\n  // }\r\n}\r\n","import { Vector2D, Angle, Line } from \".\";\r\nimport { Direction } from \"./geometry\";\r\nimport {\r\n  ICollisible,\r\n  ITransmittable,\r\n  IRotatable,\r\n  IZoomable\r\n} from \"../interfaces\";\r\nimport { Ball } from \"../mapitems/ball\";\r\nimport { Physical } from \"./kinematics\";\r\n\r\nexport abstract class Collider\r\n  implements ICollisible, ITransmittable, IRotatable, IZoomable {\r\n  public abstract crashDetect(crashable: ICollisible): boolean;\r\n  public abstract crashHandle(crashable: ICollisible): void;\r\n\r\n  protected _position!: Vector2D;\r\n  public get position(): Vector2D {\r\n    return this._position.clone();\r\n  }\r\n  public set position(position: Vector2D) {\r\n    this.translate(position);\r\n  }\r\n  public abstract get center(): Vector2D;\r\n  public abstract translate(point: Vector2D): ITransmittable;\r\n\r\n  protected _rotation: Direction = Direction.Up;\r\n  public get rotation(): Direction {\r\n    return this._rotation;\r\n  }\r\n  public set rotation(rotation: Direction) {\r\n    const times: number = (this._rotation - rotation + 4) % 4;\r\n    for (let i = 0; i < times; i++) {\r\n      this.rotate(this.center, Angle.RIGHT_ANGLE_REVERSE);\r\n    }\r\n    this._rotation = rotation;\r\n  }\r\n  public abstract rotate(center: Vector2D, angle: Angle): IRotatable;\r\n\r\n  protected _zoom = 1;\r\n  public get zoom(): number {\r\n    return this._zoom;\r\n  }\r\n\r\n  public set zoom(zoom: number) {\r\n    if (zoom <= 0) {\r\n      throw new Error(\"Zoom value must be positive\");\r\n    }\r\n    this.zoomTo(this.position, zoom);\r\n  }\r\n  public abstract zoomTo(zoomCenter: Vector2D, zoom: number): IZoomable;\r\n}\r\n\r\nexport class PolygonCollider extends Collider {\r\n  protected _edges: Line[];\r\n\r\n  /**\r\n   * 多边形的边，返回拷贝\r\n   */\r\n  public get edges(): Line[] {\r\n    return this._edges.map(item => item.clone());\r\n  }\r\n\r\n  /**\r\n   * 多边形的顶点，返回拷贝\r\n   */\r\n  public get vertexes(): Vector2D[] {\r\n    return this._vertexes.map(item => item.clone());\r\n  }\r\n\r\n  public get center(): Vector2D {\r\n    return Vector2D.average(this._vertexes);\r\n  }\r\n\r\n  constructor(\r\n    // 核心属性，顶点与边相绑定\r\n    protected _vertexes: Vector2D[],\r\n    // 校准点位置\r\n    protected _position: Vector2D = Vector2D.ZERO\r\n  ) {\r\n    super();\r\n    this._edges = this._vertexes.map(\r\n      (item, index, array) => new Line(item, array[(index + 1) % array.length])\r\n    );\r\n  }\r\n\r\n  public zoomTo(zoomCenter: Vector2D, zoom: number): IZoomable {\r\n    if (zoom !== this._zoom) {\r\n      this._vertexes.forEach(value =>\r\n        value.as(\r\n          Vector2D.add(\r\n            zoomCenter,\r\n            Vector2D.difference(value, zoomCenter).mult(zoom / this._zoom)\r\n          )\r\n        )\r\n      );\r\n    }\r\n    this._zoom = zoom;\r\n    return this;\r\n  }\r\n\r\n  public rotate(center: Vector2D, angle: Angle): IRotatable {\r\n    this._vertexes.forEach(value => value.pointRotate(center, angle));\r\n    switch (angle.special) {\r\n      case \"right-angle-reverse\":\r\n        this._rotation = (this._rotation - 1 + 4) % 4;\r\n        break;\r\n      case \"right-angle\":\r\n        this._rotation = (this._rotation + 1) % 4;\r\n        break;\r\n      case \"\":\r\n        break;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  public translate(point: Vector2D): ITransmittable {\r\n    this._vertexes.forEach(value =>\r\n      value.add(Vector2D.difference(point, this._position))\r\n    );\r\n    this._position = point.clone();\r\n    return this;\r\n  }\r\n\r\n  public crashDetect(crashable: ICollisible): boolean {\r\n    if (crashable instanceof PolygonCollider) {\r\n      const edges: Line[] = crashable.edges;\r\n      const axes: Vector2D[] = [];\r\n      for (const edge of edges) {\r\n        axes.push(edge.normalVector);\r\n      }\r\n      if (axes.length === 0) {\r\n        return PolygonCollider.polygonCollidesWithCircle(this, crashable);\r\n      } else {\r\n        for (const edge of this.edges) {\r\n          axes.push(edge.normalVector);\r\n        }\r\n        return !this.separationOnAxes(axes, crashable);\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public static polygonCollidesWithCircle(\r\n    polygon: ICollisible,\r\n    circle: ICollisible\r\n  ): boolean {\r\n    if (\r\n      polygon instanceof PolygonCollider &&\r\n      circle instanceof CircleCollider\r\n    ) {\r\n      const closestPoint: Vector2D = PolygonCollider.getPolygonPointClosestToCircle(\r\n        polygon,\r\n        circle\r\n      );\r\n      const edges: Line[] = polygon.edges;\r\n      const axes: Vector2D[] = [];\r\n      if (closestPoint !== undefined) {\r\n        for (const edge of edges) {\r\n          axes.push(edge.normalVector);\r\n        }\r\n        axes.push(Vector2D.difference(closestPoint, circle.center));\r\n        return !polygon.separationOnAxes(axes, circle);\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public separationOnAxes(\r\n    axes: Vector2D[],\r\n    crashable: PolygonCollider\r\n  ): boolean {\r\n    for (const i of axes) {\r\n      const projection1: Vector2D = this.project(i);\r\n      const projection2: Vector2D = crashable.project(i);\r\n      if (!(projection1.y > projection2.x && projection2.y > projection1.x)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public project(axis: Vector2D): Vector2D {\r\n    const scalars: number[] = [];\r\n    const v: Vector2D = new Vector2D(0, 0);\r\n    this.vertexes.forEach(point => {\r\n      v.x = point.x;\r\n      v.y = point.y;\r\n      scalars.push(v.projection(axis));\r\n    });\r\n    return new Vector2D(\r\n      Math.min.apply(Math, scalars),\r\n      Math.max.apply(Math, scalars)\r\n    );\r\n  }\r\n\r\n  public static getPolygonPointClosestToCircle(\r\n    polygon: PolygonCollider,\r\n    circle: CircleCollider | Ball\r\n  ): Vector2D {\r\n    let min = 100000;\r\n    const vertexes: Vector2D[] = polygon.vertexes;\r\n    let closestPoint: Vector2D = vertexes[0];\r\n    for (const point of vertexes) {\r\n      const length: number = Vector2D.difference(circle.center, point).radius;\r\n      if (min > length) {\r\n        min = length;\r\n        closestPoint = point;\r\n      }\r\n    }\r\n    return closestPoint;\r\n  }\r\n\r\n  public static outPointProjectionOnEdge(edge: Line, point: Vector2D): boolean {\r\n    const v1: Vector2D = Vector2D.difference(point, edge.p1),\r\n      v2: Vector2D = Vector2D.difference(point, edge.p2),\r\n      axis: Vector2D = edge.normalVector;\r\n    if (v1.dot(axis) <= 0 || v2.dot(axis) <= 0) {\r\n      // 点不在法向量一侧\r\n      return false;\r\n    } else {\r\n      const borderAxis1: Vector2D = Vector2D.difference(edge.p2, edge.p1),\r\n        borderAxis2: Vector2D = Vector2D.negate(borderAxis1);\r\n      // 判断点是否在两条直线中间\r\n      return borderAxis1.dot(v1) >= 0 && borderAxis2.dot(v2) >= 0;\r\n    }\r\n  }\r\n\r\n  public crashHandle(crashable: ICollisible): void {\r\n    if (crashable instanceof Ball) {\r\n      let refletLine: Line | null = null;\r\n      const ballPos: Vector2D = crashable.massPoint.p.add(\r\n        crashable.massPoint.v.mult(-Physical.tick)\r\n      );\r\n      for (const value of this._edges) {\r\n        if (refletLine === null) {\r\n          if (PolygonCollider.outPointProjectionOnEdge(value, ballPos)) {\r\n            refletLine = value;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      if (refletLine !== null) {\r\n        const axis: Vector2D = refletLine.normalVector;\r\n        Physical.surfaceVelocityReflect(crashable.massPoint, axis);\r\n      } else {\r\n        const closestPoint: Vector2D = PolygonCollider.getPolygonPointClosestToCircle(\r\n          this,\r\n          crashable\r\n        );\r\n        Physical.surfaceVelocityReflect(\r\n          crashable.massPoint,\r\n          Vector2D.difference(crashable.center, closestPoint)\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport class CircleCollider extends PolygonCollider {\r\n  constructor(position: Vector2D, protected _radius: number) {\r\n    super([], position.clone());\r\n  }\r\n\r\n  /**\r\n   * 半径\r\n   */\r\n  get radius(): number {\r\n    return this.zoom * this._radius;\r\n  }\r\n\r\n  /**\r\n   * 圆心\r\n   */\r\n  get center(): Vector2D {\r\n    return this.position.add(new Vector2D(this.radius, this.radius));\r\n  }\r\n\r\n  public project(axis: Vector2D): Vector2D {\r\n    const scalars: number[] = [];\r\n    const point: Vector2D = this.center;\r\n    const dotProduct: number = point.projection(axis);\r\n    scalars.push(dotProduct);\r\n    scalars.push(dotProduct - this.radius);\r\n    scalars.push(dotProduct + this.radius);\r\n    return new Vector2D(\r\n      Math.min.apply(Math, scalars),\r\n      Math.max.apply(Math, scalars)\r\n    );\r\n  }\r\n\r\n  public crashDetect(crashable: ICollisible): boolean {\r\n    if (crashable instanceof PolygonCollider) {\r\n      const edges: Line[] = crashable.edges;\r\n      const axes: Vector2D[] = [];\r\n      for (const edge of edges) {\r\n        axes.push(edge.normalVector);\r\n      }\r\n      if (axes.length === 0 && crashable instanceof CircleCollider) {\r\n        const distance: number = Vector2D.difference(\r\n          this.center,\r\n          crashable.center\r\n        ).radius;\r\n        return distance < Math.abs(this.radius + crashable.radius);\r\n      } else {\r\n        return PolygonCollider.polygonCollidesWithCircle(crashable, this);\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public crashHandle(crashable: ICollisible): void {\r\n    if (crashable instanceof Ball) {\r\n      const axis = Vector2D.difference(crashable.center, this.center);\r\n      Physical.surfaceVelocityReflect(crashable.massPoint, axis);\r\n    }\r\n  }\r\n}\r\n","import { MapItemNames } from \"../enums\";\r\nimport { ICollisible, ITransmittable } from \"../interfaces\";\r\nimport { Vector2D, Collider } from \"../physics\";\r\n\r\nexport abstract class MapItem implements ICollisible, ITransmittable {\r\n  abstract get name(): MapItemNames;\r\n  get center(): Vector2D {\r\n    return this.collider.center;\r\n  }\r\n  translate(point: Vector2D): ITransmittable {\r\n    this.collider.translate(point);\r\n    return this;\r\n  }\r\n  public crashDetect(collisible: ICollisible): boolean {\r\n    if (collisible instanceof MapItem) {\r\n      return this.collider.crashDetect(collisible.collider);\r\n    }\r\n    return this.collider.crashDetect(collisible);\r\n  }\r\n  public crashHandle(collisible: ICollisible): void {\r\n    return this.collider.crashHandle(collisible);\r\n  }\r\n\r\n  /**\r\n   * 格点大小，单位为像素\r\n   */\r\n  public static readonly gridScale: number = 36;\r\n\r\n  /**\r\n   * 单位格点的垂直正方向向量\r\n   */\r\n  public static readonly vertical: Vector2D = new Vector2D(\r\n    0,\r\n    MapItem.gridScale\r\n  );\r\n\r\n  /**\r\n   * 单位格点的水平正方向向量\r\n   */\r\n  public static readonly horizontal: Vector2D = new Vector2D(\r\n    MapItem.gridScale,\r\n    0\r\n  );\r\n\r\n  /**\r\n   * 图片素材的URL\r\n   */\r\n  abstract get imgURL(): string;\r\n\r\n  protected static currentID = 0;\r\n  public readonly id: number;\r\n\r\n  constructor(protected collider: Collider) {\r\n    this.id = ++MapItem.currentID;\r\n    console.log(`MapItem ${this.id} init`);\r\n  }\r\n\r\n  public get position(): Vector2D {\r\n    return this.collider.position;\r\n  }\r\n  public set position(position: Vector2D) {\r\n    this.collider.position = position;\r\n  }\r\n}\r\n","import { MapItem } from \"./map-item\";\r\nimport { MapItemNames } from \"../enums\";\r\nimport { ICollisible, ITransmittable } from \"../interfaces\";\r\nimport { Vector2D, CircleCollider } from \"../physics\";\r\nimport { MassPoint, Physical } from \"../physics/kinematics\";\r\n\r\nexport class Ball extends MapItem {\r\n  public get name(): MapItemNames {\r\n    return Ball.Name;\r\n  }\r\n  public get center(): Vector2D {\r\n    return this.collider.center;\r\n  }\r\n  public massPoint: MassPoint;\r\n  public pipeID = -1;\r\n  public crashHandle(crashable: ICollisible): void {\r\n    if (crashable instanceof Ball) {\r\n      Physical.perfectElasticCollision(this.massPoint, crashable.massPoint);\r\n    } else {\r\n      super.crashHandle(crashable);\r\n    }\r\n  }\r\n\r\n  public translate(p: Vector2D): ITransmittable {\r\n    super.translate(p);\r\n    this.massPoint.translate(this.center);\r\n    return this;\r\n  }\r\n  public static readonly Name: MapItemNames = \"ball\";\r\n  public static readonly imageUrl: string = \"img/item/ball.png\";\r\n\r\n  get imgURL(): string {\r\n    return Ball.imageUrl;\r\n  }\r\n\r\n  constructor(x: number, y: number) {\r\n    super(new CircleCollider(new Vector2D(x, y), MapItem.gridScale / 2));\r\n    this.massPoint = new MassPoint();\r\n    this.massPoint.translate(this.center);\r\n  }\r\n}\r\n","import { MapItemNames } from \"../enums\";\r\n\r\nexport interface ViewItem {\r\n  typeValue: ItemType;\r\n  img: string;\r\n}\r\n\r\nexport function isViewItem(obj: any): obj is ViewItem {\r\n  return obj.typeValue !== undefined;\r\n}\r\n\r\nexport interface MapElement {\r\n  x: number;\r\n  y: number;\r\n  typeValue: ItemType;\r\n  img: string;\r\n}\r\n\r\nexport type ItemType = \"select\" | MapItemNames;\r\n\r\nexport const gridLength = 35;\r\n\r\nexport const gridLineLength = 1;\r\n\r\nexport const sampleItem: ViewItem = {\r\n  typeValue: \"select\",\r\n  img: \"img/item/select.png\"\r\n};\r\nexport const selectItem: ViewItem = {\r\n  typeValue: \"select\",\r\n  img: \"img/item/select.png\"\r\n};\r\nexport const ballItem: ViewItem = {\r\n  typeValue: \"ball\",\r\n  img: \"img/item/ball.png\"\r\n};\r\nexport const absorberItem: ViewItem = {\r\n  typeValue: \"absorber\",\r\n  img: \"img/item/absorber.png\"\r\n};\r\nexport const triangleItem: ViewItem = {\r\n  typeValue: \"triangle\",\r\n  img: \"img/item/triangle.png\"\r\n};\r\nexport const circleItem: ViewItem = {\r\n  typeValue: \"circle\",\r\n  img: \"img/item/circle.png\"\r\n};\r\nexport const squareItem: ViewItem = {\r\n  typeValue: \"square\",\r\n  img: \"img/item/square.png\"\r\n};\r\nexport const pipeItem: ViewItem = {\r\n  typeValue: \"pipe\",\r\n  img: \"img/item/pipe_normal.png\"\r\n};\r\nexport const pipeTurnedItem: ViewItem = {\r\n  typeValue: \"pipe-turned\",\r\n  img: \"img/item/pipe_turned.png\"\r\n};\r\nexport const baffleAlphaItem: ViewItem = {\r\n  typeValue: \"baffle-alpha\",\r\n  img: \"img/item/baffle-mid.png\"\r\n};\r\nexport const baffleBetaItem: ViewItem = {\r\n  typeValue: \"baffle-beta\",\r\n  img: \"img/item/baffle-mid.png\"\r\n};\r\nexport const sampleItems: ViewItem[] = [sampleItem, ballItem];\r\nexport const itemss: ViewItem[][] = [\r\n  [selectItem, ballItem],\r\n  [absorberItem, triangleItem],\r\n  [circleItem, squareItem],\r\n  [pipeItem, pipeTurnedItem],\r\n  [baffleAlphaItem, baffleBetaItem]\r\n];\r\n\r\nconst itemMap: Record<ItemType, ViewItem> = {\r\n  absorber: absorberItem,\r\n  \"baffle-alpha\": baffleAlphaItem,\r\n  \"baffle-beta\": baffleBetaItem,\r\n  ball: ballItem,\r\n  circle: circleItem,\r\n  pipe: pipeItem,\r\n  \"pipe-turned\": pipeTurnedItem,\r\n  select: selectItem,\r\n  square: squareItem,\r\n  triangle: triangleItem,\r\n  border: selectItem\r\n};\r\nexport function getViewItemByType(typeValue: ItemType): ViewItem {\r\n  return itemMap[typeValue];\r\n}\r\n\r\nexport const Gizmo = {\r\n  gridLength, gridLineLength, sampleItem,\r\n  selectItem, ballItem, absorberItem, triangleItem, circleItem, squareItem, pipeItem, pipeTurnedItem,\r\n  baffleAlphaItem, baffleBetaItem, sampleItems: [sampleItem, ballItem],\r\n  itemss: [\r\n    [selectItem, ballItem],\r\n    [absorberItem, triangleItem],\r\n    [circleItem, squareItem],\r\n    [pipeItem, pipeTurnedItem],\r\n    [baffleAlphaItem, baffleBetaItem]\r\n  ], itemMap: {\r\n    absorber: absorberItem,\r\n    \"baffle-alpha\": baffleAlphaItem,\r\n    \"baffle-beta\": baffleBetaItem,\r\n    ball: ballItem,\r\n    circle: circleItem,\r\n    pipe: pipeItem,\r\n    \"pipe-turned\": pipeTurnedItem,\r\n    select: selectItem,\r\n    square: squareItem,\r\n    triangle: triangleItem,\r\n    border: selectItem\r\n  }, getViewItemByType(typeValue: ItemType): ViewItem {\r\n    return itemMap[typeValue];\r\n  }\r\n}\r\n","import { ViewItem, Gizmo } from \"@/core/constants/gizmo\";\r\nimport { MapItem } from \"@/core/mapitems/map-item\";\r\nimport { Vector2D } from \"@/core/physics\";\r\nimport TSViews from \"@/views/TSViews\";\r\n\r\nexport interface Module1State {\r\n  useLightTheme: boolean;\r\n  currentMode: \"LAYOUT\" | \"PLAY\";\r\n  currentState: \"PAUSE\" | \"PLAYING\";\r\n  draggingItem: MapItem | ViewItem | null;\r\n  draggingItemOffset: Vector2D;\r\n  toolZoneCurrentItem: ViewItem;\r\n  panelCurrentItem: MapItem | null;\r\n}\r\n\r\nexport default {\r\n  state: {\r\n    useLightTheme: true,\r\n    currentMode: \"LAYOUT\",\r\n    currentState: \"PAUSE\",\r\n    draggingItem: null,\r\n    draggingItemOffset: new Vector2D(0, 0),\r\n    toolZoneCurrentItem: Gizmo.selectItem,\r\n    panelCurrentItem: null\r\n  } as Module1State,\r\n  mutations: {\r\n    changeTheme(state: Module1State, useLight: boolean) {\r\n      state.useLightTheme = useLight;\r\n      const theme: string = useLight ? \"light\" : \"dark\";\r\n      document\r\n        .getElementById(\"app-skin\")\r\n        ?.setAttribute(\"href\", `skin/${theme}/skin.css`);\r\n    },\r\n    changeMode(state: Module1State, currentMode: \"LAYOUT\" | \"PLAY\") {\r\n      state.currentMode = currentMode;\r\n    },\r\n    changeState(state: Module1State, currentState: \"PAUSE\" | \"PLAYING\") {\r\n      state.currentState = currentState;\r\n    },\r\n    changeDraggingItem(\r\n      state: Module1State,\r\n      draggingItem: MapItem | ViewItem | null\r\n    ) {\r\n      state.draggingItem = draggingItem;\r\n    },\r\n    changeDraggingItemOffset(\r\n      state: Module1State,\r\n      draggingItemOffset: Vector2D\r\n    ) {\r\n      state.draggingItemOffset = draggingItemOffset;\r\n    },\r\n    changeToolZoneCurrentItem(\r\n      state: Module1State,\r\n      toolZoneCurrentItem: ViewItem\r\n    ) {\r\n      state.toolZoneCurrentItem = toolZoneCurrentItem;\r\n      if (toolZoneCurrentItem.typeValue !== \"select\") {\r\n        state.panelCurrentItem == null;\r\n      }\r\n    },\r\n    changePanelCurrentItem(\r\n      state: Module1State,\r\n      panelCurrentItem: MapItem | null\r\n    ) {\r\n      state.panelCurrentItem = panelCurrentItem;\r\n    }\r\n  },\r\n  actions: {},\r\n  modules: {}\r\n} as const;\r\n","import Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport { createDirectStore } from \"direct-vuex\";\nimport module1 from \"./module1\";\n\nVue.use(Vuex);\n\nconst { store, rootActionContext, moduleActionContext } = createDirectStore({\n  modules: {\n    module1\n  }\n} as const);\n\nexport default store;\n\nexport { rootActionContext, moduleActionContext };\n\nexport type AppStore = typeof store;\ndeclare module \"vuex\" {\n  interface Store<S> {\n    direct: AppStore;\n  }\n}\n","import { IRotatable, IZoomable } from \"../interfaces\";\r\n\r\nexport function isRotatable(obj: any): obj is IRotatable {\r\n  return obj.rotate !== undefined;\r\n}\r\n\r\nexport function isZoomable(obj: any): obj is IZoomable {\r\n  return obj.zoomTo !== undefined;\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { MapItem } from \"@/core/mapitems/map-item\";\r\nimport { Ball } from \"@/core/mapitems/ball\";\r\nimport store from \"@/store\";\r\nimport { Vector2D } from \"@/core/physics\";\r\nimport { Gizmo } from \"@/core/constants/gizmo\";\r\nimport { isRotatable, isZoomable } from \"@/core/common\";\r\n\r\n@Component\r\nexport default class ItemImage extends Vue {\r\n  @Prop() private item!: MapItem;\r\n  @Prop() private selected!: boolean;\r\n\r\n  $refs!: {\r\n    img: HTMLElement;\r\n  };\r\n\r\n  get cssClass(): string {\r\n    return this.selected ? \"pick-box\" : \"\";\r\n  }\r\n\r\n  get rotation(): number {\r\n    if (isRotatable(this.item)) {\r\n      return this.item.rotation * 90;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  get zindex(): number {\r\n    if (this.item instanceof Ball) {\r\n      return 100;\r\n    } else {\r\n      return 1;\r\n    }\r\n  }\r\n\r\n  private readonly defaultSize: number =\r\n    Gizmo.gridLength + Gizmo.gridLineLength;\r\n\r\n  get width(): number {\r\n    let base: number = this.defaultSize;\r\n    if (this.item.name === \"baffle-alpha\" || this.item.name === \"baffle-beta\") {\r\n      base = base * 2 - 1;\r\n    }\r\n    let result: number = base - 1;\r\n    if (isZoomable(this.item)) {\r\n      result = this.item.zoom * base - 1;\r\n    }\r\n    return result;\r\n  }\r\n\r\n  get height(): number {\r\n    let result: number = this.defaultSize - 1;\r\n    if (isZoomable(this.item)) {\r\n      result = this.item.zoom * this.defaultSize - 1;\r\n    }\r\n    return result;\r\n  }\r\n\r\n  get imageDraggable(): boolean {\r\n    const m = store.state.module1;\r\n    if (\r\n      m.currentMode == \"LAYOUT\" &&\r\n      m.toolZoneCurrentItem.typeValue == \"select\"\r\n    ) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  onDragstart(event: DragEvent) {\r\n    store.commit.changeDraggingItemOffset(\r\n      new Vector2D(event.offsetX, event.offsetY)\r\n    );\r\n    store.commit.changeDraggingItem(this.item);\r\n  }\r\n\r\n  onDragend() {\r\n    store.commit.changeDraggingItem(null);\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemImage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemImage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ItemImage.vue?vue&type=template&id=92cbf116&scoped=true&\"\nimport script from \"./ItemImage.vue?vue&type=script&lang=ts&\"\nexport * from \"./ItemImage.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ItemImage.vue?vue&type=style&index=0&id=92cbf116&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"92cbf116\",\n  null\n  \n)\n\nexport default component.exports","import { Direction } from \"../physics\";\r\nimport { MapItem } from \"./map-item\";\r\nimport { IRotatable, IZoomable } from \"../interfaces\";\r\nimport { PolygonCollider, Vector2D, Angle } from \"../physics\";\r\n\r\nexport abstract class PolygonMapItem extends MapItem\r\n  implements IRotatable, IZoomable {\r\n  constructor(protected collider: PolygonCollider) {\r\n    super(collider);\r\n  }\r\n  get zoom(): number {\r\n    return this.collider.zoom;\r\n  }\r\n  zoomTo(zoomCenter: Vector2D, zoom: number): IZoomable {\r\n    this.collider.zoomTo(zoomCenter, zoom);\r\n    return this;\r\n  }\r\n  get rotation(): Direction {\r\n    return this.collider.rotation;\r\n  }\r\n  set rotation(rotation: Direction) {\r\n    this.collider.rotation = rotation;\r\n  }\r\n  rotate(center: Vector2D, angle: Angle): IRotatable {\r\n    this.collider.rotate(center, angle);\r\n    return this;\r\n  }\r\n  public get center(): Vector2D {\r\n    return this.collider.center;\r\n  }\r\n}\r\n","import { MapItem } from \"./map-item\";\r\nimport { MapItemNames } from \"../enums\";\r\nimport { PolygonCollider, Vector2D } from \"../physics\";\r\nimport { PolygonMapItem } from \"./polygon\";\r\n\r\nexport class SquareCollider extends PolygonCollider {\r\n  public get center(): Vector2D {\r\n    return this.position.add(\r\n      MapItem.vertical\r\n        .clone()\r\n        .add(MapItem.horizontal)\r\n        .mult(0.5 * this.zoom)\r\n    );\r\n  }\r\n  constructor(position: Vector2D) {\r\n    super(\r\n      [\r\n        position.clone(),\r\n        position.clone().add(MapItem.vertical),\r\n        position\r\n          .clone()\r\n          .add(MapItem.horizontal)\r\n          .add(MapItem.vertical),\r\n        position.clone().add(MapItem.horizontal)\r\n      ],\r\n      position\r\n    );\r\n  }\r\n}\r\n\r\nexport class SquareMapItem extends PolygonMapItem {\r\n  public get name(): MapItemNames {\r\n    return SquareMapItem.Name;\r\n  }\r\n  get imgURL(): string {\r\n    return SquareMapItem.imageUrl;\r\n  }\r\n\r\n  public static readonly Name: MapItemNames = \"square\";\r\n  public static readonly imageUrl: string = \"img/item/square.png\";\r\n\r\n  constructor(x: number, y: number) {\r\n    super(new SquareCollider(new Vector2D(x, y)));\r\n  }\r\n}\r\n","import Controller from \"../controller/Controller\";\r\nimport { MapItemNames } from \"../enums\";\r\nimport { ICollisible } from \"../interfaces\";\r\nimport { Vector2D } from \"../physics\";\r\nimport { Ball } from \"./ball\";\r\nimport { PolygonMapItem } from \"./polygon\";\r\nimport { SquareCollider } from \"./square\";\r\n\r\nexport class AbsorberMapItem extends PolygonMapItem {\r\n  public static readonly imageURL: string = \"img/item/absorber.png\";\r\n  public static readonly Name: MapItemNames = \"absorber\";\r\n  get name(): MapItemNames {\r\n    return AbsorberMapItem.Name;\r\n  }\r\n  get imgURL(): string {\r\n    return AbsorberMapItem.imageURL;\r\n  }\r\n  constructor(x: number, y: number) {\r\n    super(new SquareCollider(new Vector2D(x, y)));\r\n  }\r\n  public crashHandle(ball: ICollisible): void {\r\n    if (ball instanceof Ball) {\r\n      Controller.getInstance().handleAbsorb(ball.id);\r\n    }\r\n  }\r\n}\r\n","import { MapItemNames } from \"../enums\";\r\nimport { PolygonCollider, Vector2D } from \"../physics\";\r\nimport { MapItem } from \"./map-item\";\r\n\r\nexport class BaffleCollider extends PolygonCollider {\r\n  constructor(position: Vector2D) {\r\n    const vertical: Vector2D = MapItem.vertical.clone().mult(0.25);\r\n    const horizontal: Vector2D = MapItem.horizontal.clone().mult(2);\r\n    super(\r\n      [\r\n        position.clone(),\r\n        position.clone().add(vertical),\r\n        position\r\n          .clone()\r\n          .add(horizontal)\r\n          .add(vertical),\r\n        position.clone().add(horizontal)\r\n      ],\r\n      position\r\n    );\r\n  }\r\n}\r\n\r\nexport abstract class BaffleMapItem extends MapItem {\r\n  get imgURL(): string {\r\n    return BaffleMapItem.imageURL;\r\n  }\r\n\r\n  public static readonly imageURL: string = \"img/item/baffle.png\";\r\n\r\n  constructor(x: number, y: number) {\r\n    super(new BaffleCollider(new Vector2D(x, y)));\r\n  }\r\n\r\n  public move(offset: Vector2D): BaffleMapItem {\r\n    this.translate(this.position.add(offset));\r\n    return this;\r\n  }\r\n}\r\n\r\nexport class BaffleAlphaMapItem extends BaffleMapItem {\r\n  get name(): MapItemNames {\r\n    return BaffleAlphaMapItem.Name;\r\n  }\r\n  public static readonly Name: MapItemNames = \"baffle-alpha\";\r\n}\r\n\r\nexport class BaffleBetaMapItem extends BaffleMapItem {\r\n  get name(): MapItemNames {\r\n    return BaffleBetaMapItem.Name;\r\n  }\r\n  public static readonly Name: MapItemNames = \"baffle-beta\";\r\n}\r\n","import Controller from \"../controller/Controller\";\r\nimport { MapItemNames } from \"../enums\";\r\nimport {\r\n  ICollisible,\r\n  ITransmittable,\r\n  IRotatable,\r\n  IZoomable\r\n} from \"../interfaces\";\r\nimport { Collider, PolygonCollider, Vector2D, Angle } from \"../physics\";\r\nimport { Ball } from \"./ball\";\r\nimport { MapItem } from \"./map-item\";\r\n\r\nexport class BorderCollider extends Collider {\r\n  protected borders: PolygonCollider[] = [];\r\n  constructor() {\r\n    super();\r\n    this._position = Vector2D.ZERO;\r\n    const vertical: Vector2D = MapItem.vertical.clone(),\r\n      horizontal: Vector2D = MapItem.horizontal.clone(),\r\n      verticalMax: Vector2D = Vector2D.mult(vertical, Controller.maxGridCount),\r\n      horizontalMax: Vector2D = Vector2D.mult(\r\n        horizontal,\r\n        Controller.maxGridCount\r\n      );\r\n\r\n    this.borders.push(\r\n      new PolygonCollider([\r\n        Vector2D.negate(horizontal),\r\n        Vector2D.difference(verticalMax, horizontal),\r\n        Vector2D.copy(verticalMax),\r\n        Vector2D.ZERO\r\n      ])\r\n    );\r\n    this.borders.push(\r\n      new PolygonCollider([\r\n        Vector2D.copy(verticalMax),\r\n        Vector2D.add(verticalMax, vertical),\r\n        Vector2D.add(verticalMax, vertical).add(horizontalMax),\r\n        Vector2D.add(horizontalMax, verticalMax)\r\n      ])\r\n    );\r\n    this.borders.push(\r\n      new PolygonCollider([\r\n        Vector2D.copy(horizontalMax),\r\n        Vector2D.add(verticalMax, horizontalMax),\r\n        Vector2D.add(verticalMax, horizontalMax).add(horizontal),\r\n        Vector2D.add(horizontal, horizontalMax)\r\n      ])\r\n    );\r\n    this.borders.push(\r\n      new PolygonCollider([\r\n        Vector2D.negate(vertical),\r\n        Vector2D.ZERO,\r\n        Vector2D.copy(horizontalMax),\r\n        Vector2D.difference(horizontalMax, vertical)\r\n      ])\r\n    );\r\n  }\r\n\r\n  public crashDetect(crashable: ICollisible): boolean {\r\n    for (const border of this.borders) {\r\n      if (border.crashDetect(crashable) || crashable.crashDetect(border)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n  public crashHandle(crashable: ICollisible): void {\r\n    if (crashable instanceof Ball) {\r\n      for (const border of this.borders) {\r\n        if (crashable.crashDetect(border)) {\r\n          border.crashHandle(crashable);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  public get center(): Vector2D {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n  public translate(point: Vector2D): ITransmittable {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n  public rotate(center: Vector2D, angle: Angle): IRotatable {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n  public zoomTo(zoomCenter: Vector2D, zoom: number): IZoomable {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n}\r\n\r\nexport class BorderMapItem extends MapItem {\r\n  get name(): MapItemNames {\r\n    return \"border\";\r\n  }\r\n  get imgURL(): string {\r\n    return \"\";\r\n  }\r\n  constructor() {\r\n    super(new BorderCollider());\r\n  }\r\n}\r\n","import { MapItem } from \"./map-item\";\r\nimport { MapItemNames } from \"../enums\";\r\nimport { CircleCollider, Vector2D } from \"../physics\";\r\nimport { PolygonMapItem } from \"./polygon\";\r\n\r\nexport class CircleMapItem extends PolygonMapItem {\r\n  public static readonly imageURL: string = \"img/item/circle.png\";\r\n  public static readonly Name: MapItemNames = \"circle\";\r\n  get name(): MapItemNames {\r\n    return CircleMapItem.Name;\r\n  }\r\n  get imgURL(): string {\r\n    return CircleMapItem.imageURL;\r\n  }\r\n  constructor(x: number, y: number) {\r\n    super(new CircleCollider(new Vector2D(x, y), MapItem.gridScale / 2));\r\n  }\r\n}\r\n","import { Direction } from \"../physics\";\r\nimport { MapItem } from \"./map-item\";\r\nimport { MapItemNames } from \"../enums\";\r\nimport { ICollisible, IRotatable } from \"../interfaces\";\r\nimport { PolygonCollider, Vector2D, Angle, Line } from \"../physics\";\r\nimport { MassPoint, Physical } from \"../physics/kinematics\";\r\nimport { Ball } from \"./ball\";\r\n\r\nexport class PipeCollider extends PolygonCollider {\r\n  public get center(): Vector2D {\r\n    return this.position.add(\r\n      MapItem.vertical\r\n        .clone()\r\n        .add(MapItem.horizontal)\r\n        .mult(0.5 * this.zoom)\r\n    );\r\n  }\r\n  constructor(position: Vector2D) {\r\n    super(\r\n      [\r\n        position.clone(),\r\n        position.clone().add(MapItem.vertical),\r\n        position\r\n          .clone()\r\n          .add(MapItem.horizontal)\r\n          .add(MapItem.vertical),\r\n        position.clone().add(MapItem.horizontal)\r\n      ],\r\n      position\r\n    );\r\n  }\r\n\r\n  public crashHandle(crashable: ICollisible) {\r\n    super.crashHandle(crashable);\r\n  }\r\n}\r\n\r\nexport class PipeMapItem extends MapItem implements IRotatable {\r\n  get rotation(): Direction {\r\n    return this.collider.rotation;\r\n  }\r\n  set rotation(rotation: Direction) {\r\n    this.collider.rotation = rotation;\r\n  }\r\n  rotate(center: Vector2D, angle: Angle): IRotatable {\r\n    this.collider.rotate(center, angle);\r\n    return this;\r\n  }\r\n  public get name(): MapItemNames {\r\n    return PipeMapItem.Name;\r\n  }\r\n  get imgURL(): string {\r\n    return PipeMapItem.imageUrl;\r\n  }\r\n\r\n  public static readonly Name: MapItemNames = \"pipe\";\r\n  public static readonly imageUrl: string = \"img/item/pipe_normal.png\";\r\n  protected collider!: PolygonCollider;\r\n  constructor(x: number, y: number) {\r\n    super(new PipeCollider(new Vector2D(x, y)));\r\n    // this.collider = new PipeCollider(new Vector2D(x, y));\r\n  }\r\n\r\n  public crashHandle(crashable: ICollisible) {\r\n    // 断言已经碰撞\r\n    if (crashable instanceof Ball) {\r\n      const massPoint: MassPoint = crashable.massPoint;\r\n      const v: Vector2D = massPoint.v;\r\n      let crashLine: Line | null = null;\r\n      const ballPos: Vector2D = crashable.massPoint.p.add(\r\n        massPoint.v.mult(-Physical.tick)\r\n      );\r\n      // 获取碰撞边\r\n      const edges: Line[] = this.collider.edges;\r\n      for (const edge of edges) {\r\n        const v1: Vector2D = Vector2D.difference(ballPos, edge.p1);\r\n        const v2: Vector2D = Vector2D.difference(ballPos, edge.p2);\r\n        if (crashLine === null) {\r\n          const axis: Vector2D = edge.normalVector;\r\n          if (v1.dot(axis) >= 0 && v2.dot(axis) >= 0) {\r\n            crashLine = edge;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      if (crashLine !== null) {\r\n        // 管道外部\r\n        // console.log(\"out!\");\r\n        // 通过向量终点比较，判断碰撞线是否为可碰撞的侧边\r\n        if (\r\n          crashLine.p1.equals(edges[0].p1) ||\r\n          crashLine.p1.equals(edges[2].p1)\r\n        ) {\r\n          // 侧边\r\n          // console.log(\"side!\");\r\n          this.collider.crashHandle(crashable);\r\n        } else {\r\n          // 管道口\r\n          const axis: Vector2D = crashLine.normalVector;\r\n\r\n          if (v.dot(axis) < 0) {\r\n            // 准备进入管道\r\n            // console.log(\"entry!\");\r\n            const lineCenter: Vector2D = Vector2D.center([\r\n              crashLine.p1,\r\n              crashLine.p2\r\n            ]);\r\n            const ballCenter: Vector2D = crashable.center;\r\n            if (\r\n              Math.abs(\r\n                Vector2D.difference(ballCenter, lineCenter).projection(\r\n                  crashLine.directionVector\r\n                )\r\n              ) < 10\r\n            ) {\r\n              // console.log(\"move!\");\r\n              // 若从其它管道进入，则不改变速度大小，只改变方向\r\n              if (crashable.pipeID !== -1) {\r\n                massPoint.setVelocity(\r\n                  v\r\n                    .component(axis)\r\n                    .mult(v.radius / Math.abs(v.projection(axis)))\r\n                );\r\n              } else {\r\n                massPoint.setVelocity(v.component(axis));\r\n              }\r\n              crashable.pipeID = this.id;\r\n              const change: Vector2D = Vector2D.difference(\r\n                lineCenter,\r\n                ballCenter\r\n              ).component(crashLine.directionVector);\r\n              crashable.translate(crashable.position.add(change));\r\n            } else {\r\n              // console.log(\"bounce!\");\r\n              this.collider.crashHandle(crashable);\r\n            }\r\n          } else {\r\n            // 出管道\r\n            // console.log(\"exit!\");\r\n            if (crashable.pipeID === this.id) {\r\n              crashable.pipeID = -1;\r\n              massPoint.setAcceleration(\"pipe\", Vector2D.ZERO);\r\n              massPoint.setAcceleration(\"centripetal\", Vector2D.ZERO);\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        // 管道内\r\n        // console.log(\"in!\");\r\n        massPoint.setAcceleration(\"pipe\", Physical.pipeAcc);\r\n        massPoint.setAcceleration(\"centripetal\", Vector2D.ZERO);\r\n        // todo\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Direction } from \"../physics\";\r\nimport { MapItemNames } from \"../enums\";\r\nimport { IRotatable, ICollisible } from \"../interfaces\";\r\nimport { PolygonCollider, Vector2D, Angle, Line } from \"../physics\";\r\nimport { MassPoint, Physical } from \"../physics/kinematics\";\r\nimport { Ball } from \"./ball\";\r\nimport { MapItem } from \"./map-item\";\r\n\r\nexport class PipeTurnedCollider extends PolygonCollider {\r\n  public get center(): Vector2D {\r\n    return this.position.add(\r\n      MapItem.vertical\r\n        .clone()\r\n        .add(MapItem.horizontal)\r\n        .mult(0.5 * this.zoom)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 转弯点\r\n   */\r\n  public get centre(): Vector2D {\r\n    return this._vertexes[2].clone();\r\n  }\r\n  public get entryAxis1(): Vector2D {\r\n    return this._edges[1].normalVector;\r\n  }\r\n  public get entryAxis2(): Vector2D {\r\n    return this._edges[2].normalVector;\r\n  }\r\n  constructor(position: Vector2D) {\r\n    super(\r\n      [\r\n        position.clone(),\r\n        position.clone().add(MapItem.vertical),\r\n        position\r\n          .clone()\r\n          .add(MapItem.horizontal)\r\n          .add(MapItem.vertical),\r\n        position.clone().add(MapItem.horizontal)\r\n      ],\r\n      position\r\n    );\r\n  }\r\n}\r\n\r\nexport class PipeTurnedMapItem extends MapItem implements IRotatable {\r\n  public get rotation(): Direction {\r\n    return this.collider.rotation;\r\n  }\r\n  public set rotation(rotation: Direction) {\r\n    this.collider.rotation = rotation;\r\n  }\r\n  rotate(center: Vector2D, angle: Angle): IRotatable {\r\n    this.collider.rotate(center, angle);\r\n    return this;\r\n  }\r\n  public get name(): MapItemNames {\r\n    return PipeTurnedMapItem.Name;\r\n  }\r\n  get imgURL(): string {\r\n    return PipeTurnedMapItem.imageUrl;\r\n  }\r\n\r\n  public static readonly Name: MapItemNames = \"pipe-turned\";\r\n  public static readonly imageUrl: string = \"img/item/pipe_turned.png\";\r\n  protected collider!: PipeTurnedCollider;\r\n  constructor(x: number, y: number) {\r\n    super(new PipeTurnedCollider(new Vector2D(x, y)));\r\n  }\r\n\r\n  public crashHandle(crashable: ICollisible): void {\r\n    // 断言已经碰撞\r\n    if (crashable instanceof Ball) {\r\n      const massPoint: MassPoint = crashable.massPoint;\r\n      const v: Vector2D = massPoint.v;\r\n      let crashLine: Line | null = null;\r\n      const ballPos: Vector2D = crashable.massPoint.p.add(\r\n        massPoint.v.mult(-Physical.tick)\r\n      );\r\n      // 获取碰撞边\r\n      const edges: Line[] = this.collider.edges;\r\n      for (const edge of edges) {\r\n        const v1: Vector2D = Vector2D.difference(ballPos, edge.p1);\r\n        const v2: Vector2D = Vector2D.difference(ballPos, edge.p2);\r\n        if (crashLine === null) {\r\n          const axis: Vector2D = edge.normalVector;\r\n          if (v1.dot(axis) >= 0 && v2.dot(axis) >= 0) {\r\n            crashLine = edge;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      if (crashLine !== null) {\r\n        // 管道外部\r\n        // 通过向量终点比较，判断碰撞线是否为可碰撞的侧边\r\n        if (\r\n          crashLine.p1.equals(edges[0].p1) ||\r\n          crashLine.p1.equals(edges[3].p1)\r\n        ) {\r\n          // 侧边\r\n          // console.log(\"side!\");\r\n          this.collider.crashHandle(crashable);\r\n        } else {\r\n          // 管道口\r\n          const axis: Vector2D = crashLine.normalVector;\r\n\r\n          if (v.dot(axis) < 0) {\r\n            // 准备进入管道\r\n            // console.log(\"entry!\");\r\n            const lineCenter: Vector2D = Vector2D.center([\r\n              crashLine.p1,\r\n              crashLine.p2\r\n            ]);\r\n            const ballCenter: Vector2D = crashable.center;\r\n            if (\r\n              Math.abs(\r\n                Vector2D.difference(ballCenter, lineCenter).projection(\r\n                  crashLine.directionVector\r\n                )\r\n              ) < 10\r\n            ) {\r\n              // console.log(\"move!\");\r\n              crashable.pipeID = this.id;\r\n              massPoint.setVelocity(v.component(axis));\r\n              massPoint.setAcceleration(\"pipe\", Physical.pipeAcc);\r\n              const change: Vector2D = Vector2D.difference(\r\n                lineCenter,\r\n                ballCenter\r\n              ).component(crashLine.directionVector);\r\n              crashable.translate(crashable.position.add(change));\r\n            } else {\r\n              // console.log(\"bounce!\");\r\n              this.collider.crashHandle(crashable);\r\n            }\r\n          } else {\r\n            // 出管道\r\n            // console.log(\"exit!\");\r\n            if (crashable.pipeID === this.id) {\r\n              crashable.pipeID = -1;\r\n              massPoint.setAcceleration(\"pipe\", Vector2D.ZERO);\r\n              massPoint.setAcceleration(\"centripetal\", Vector2D.ZERO);\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        // 管道内\r\n        // console.log(\"in!\");\r\n        if (Vector2D.difference(crashable.center, this.center).radius < 5) {\r\n          if (this.collider.entryAxis1.dot(v) < 0) {\r\n            // 从entryAxis1进入\r\n            crashable.translate(this.position);\r\n            massPoint.setVelocity(\r\n              v.clone().directionRotate(this.collider.entryAxis2)\r\n            );\r\n          } else if (this.collider.entryAxis2.dot(v) < 0) {\r\n            // 从entryAxis2进入\r\n            crashable.translate(this.position);\r\n            massPoint.setVelocity(\r\n              v.clone().directionRotate(this.collider.entryAxis1)\r\n            );\r\n          }\r\n        }\r\n        // const a:Vector2D = Physical.centripetalAcceleration(crashable.massPoint, MapItem.gridScale / 2, edges[1].p2);\r\n        // console.log(a);\r\n        // crashable.massPoint.setAcceleration(\"centripetal\", a);\r\n        // todo\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { MapItem } from \"./map-item\";\r\nimport { MapItemNames } from \"../enums\";\r\nimport { PolygonCollider, Vector2D } from \"../physics\";\r\nimport { PolygonMapItem } from \"./polygon\";\r\n\r\nexport class TriangleCollider extends PolygonCollider {\r\n  public get center(): Vector2D {\r\n    return this.position.add(\r\n      MapItem.vertical\r\n        .clone()\r\n        .add(MapItem.horizontal)\r\n        .mult(0.5 * this.zoom)\r\n    );\r\n  }\r\n  constructor(position: Vector2D) {\r\n    super(\r\n      [\r\n        position.clone(),\r\n        position.clone().add(MapItem.vertical),\r\n        position\r\n          .clone()\r\n          .add(MapItem.horizontal)\r\n          .add(MapItem.vertical)\r\n      ],\r\n      position\r\n    );\r\n  }\r\n}\r\n\r\nexport class TriangleMapItem extends PolygonMapItem {\r\n  public get name(): MapItemNames {\r\n    return TriangleMapItem.Name;\r\n  }\r\n  public get center(): Vector2D {\r\n    return this.collider.center;\r\n  }\r\n  get imgURL(): string {\r\n    return TriangleMapItem.imageUrl;\r\n  }\r\n  public static readonly Name: MapItemNames = \"triangle\";\r\n  public static readonly imageUrl: string = \"img/item/triangle.png\";\r\n  constructor(x: number, y: number) {\r\n    super(new TriangleCollider(new Vector2D(x, y)));\r\n  }\r\n}\r\n","import { MapItemNames } from \"../enums\";\r\nimport { AbsorberMapItem } from \"../mapitems/absorber\";\r\nimport { BaffleAlphaMapItem, BaffleBetaMapItem } from \"../mapitems/baffle\";\r\nimport { Ball } from \"../mapitems/ball\";\r\nimport { BorderMapItem } from \"../mapitems/border-map-item\";\r\nimport { CircleMapItem } from \"../mapitems/circle\";\r\nimport { PipeMapItem } from \"../mapitems/pipe\";\r\nimport { PipeTurnedMapItem } from \"../mapitems/pipe-turned\";\r\nimport { SquareMapItem } from \"../mapitems/square\";\r\nimport { TriangleMapItem } from \"../mapitems/triangle\";\r\n\r\nexport type MapItems =\r\n  | typeof AbsorberMapItem\r\n  | typeof BaffleAlphaMapItem\r\n  | typeof BaffleBetaMapItem\r\n  | typeof Ball\r\n  | typeof BorderMapItem\r\n  | typeof CircleMapItem\r\n  | typeof PipeMapItem\r\n  | typeof PipeTurnedMapItem\r\n  | typeof SquareMapItem\r\n  | typeof TriangleMapItem;\r\n\r\nconst itemMap: Record<MapItemNames, MapItems> = {\r\n  absorber: AbsorberMapItem,\r\n  \"baffle-alpha\": BaffleAlphaMapItem,\r\n  \"baffle-beta\": BaffleBetaMapItem,\r\n  ball: Ball,\r\n  border: BorderMapItem,\r\n  circle: CircleMapItem,\r\n  pipe: PipeMapItem,\r\n  \"pipe-turned\": PipeTurnedMapItem,\r\n  square: SquareMapItem,\r\n  triangle: TriangleMapItem\r\n};\r\n\r\nexport { itemMap };\r\n","import { Direction } from \"../physics\";\r\nimport { isRotatable, isZoomable } from \"../common\";\r\nimport { itemMap } from \"../constants\";\r\nimport { MapItemNames } from \"../enums\";\r\nimport { BaffleAlphaMapItem, BaffleBetaMapItem } from \"../mapitems/baffle\";\r\nimport { Ball } from \"../mapitems/ball\";\r\nimport { BorderMapItem } from \"../mapitems/border-map-item\";\r\nimport { MapItem } from \"../mapitems/map-item\";\r\nimport { Vector2D, Angle } from \"../physics\";\r\nimport { Physical } from \"../physics/kinematics\";\r\n\r\nabstract class MapItemJSON {\r\n  abstract name: MapItemNames;\r\n  abstract position: Vector2D;\r\n  abstract zoom?: number;\r\n  abstract rotation?: Direction;\r\n  public static createFromJSON(obj: any): MapItemJSON | null {\r\n    if (\r\n      obj.name &&\r\n      obj.position &&\r\n      obj.position.x !== undefined &&\r\n      obj.position.y !== undefined\r\n    ) {\r\n      return {\r\n        name: obj.name,\r\n        position: new Vector2D(obj.position.x, obj.position.y),\r\n        zoom: obj.zoom,\r\n        rotation: obj.rotation\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n\r\nexport class Controller {\r\n  private static controller: Controller;\r\n  public static readonly maxGridCount: number = 20;\r\n  public static readonly maxXY: number =\r\n    Controller.maxGridCount * MapItem.gridScale;\r\n  public static getInstance(): Controller {\r\n    return this.controller ?? (this.controller = new Controller());\r\n  }\r\n\r\n  private mapItems: Map<number, MapItem>;\r\n  private savedJSONString: string;\r\n  private balls: Map<number, Ball>;\r\n  private border: BorderMapItem;\r\n  private alphaBaffles: Map<number, BaffleAlphaMapItem>;\r\n  private betaBaffles: Map<number, BaffleBetaMapItem>;\r\n  private constructor() {\r\n    this.mapItems = new Map<number, MapItem>();\r\n    this.balls = new Map<number, Ball>();\r\n    this.border = new BorderMapItem();\r\n    this.mapItems.set(this.border.id, this.border);\r\n    this.alphaBaffles = new Map<number, BaffleAlphaMapItem>();\r\n    this.betaBaffles = new Map<number, BaffleBetaMapItem>();\r\n    this.savedJSONString = this.mapItemsToJSON(this.mapItems);\r\n  }\r\n\r\n  public get items(): MapItem[] {\r\n    const mapItem: MapItem[] = [];\r\n    for (const [, item] of this.mapItems) {\r\n      if (!(item instanceof BorderMapItem)) {\r\n        mapItem.push(item);\r\n      }\r\n    }\r\n    return mapItem;\r\n  }\r\n\r\n  /**\r\n   * 创建地图元素实例\r\n   * @param name 类型\r\n   * @param x\r\n   * @param y\r\n   * @returns 是否成功\r\n   */\r\n  public createMapItem(\r\n    name: MapItemNames,\r\n    x: number,\r\n    y: number\r\n  ): MapItem | null {\r\n    const mapItem = new itemMap[name](x, y);\r\n    if (this.handleAddItem(mapItem)) {\r\n      this.savedJSONString = this.mapItemsToJSON(this.mapItems);\r\n      return mapItem;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  private loadMapItemsFromItems(items: MapItem[]) {\r\n    this.clearAll();\r\n    for (const item of items) {\r\n      if (item instanceof Ball) {\r\n        this.balls.set(item.id, item);\r\n      } else if (item instanceof BaffleAlphaMapItem) {\r\n        this.alphaBaffles.set(item.id, item);\r\n      } else if (item instanceof BaffleBetaMapItem) {\r\n        this.betaBaffles.set(item.id, item);\r\n      }\r\n      this.mapItems.set(item.id, item);\r\n    }\r\n  }\r\n\r\n  private loadMapItemsFromJSON(content: string) {\r\n    const items = this.readFromJSON(content);\r\n    if (items != null) {\r\n      this.loadMapItemsFromItems(items);\r\n    } else {\r\n      throw new Error(\"内部读取错误\");\r\n    }\r\n  }\r\n\r\n  private readFromJSON(content: string): MapItem[] | null {\r\n    const jsonItems = JSON.parse(content);\r\n    const items: MapItem[] = [];\r\n    if (jsonItems instanceof Array) {\r\n      for (const jsonItem of jsonItems) {\r\n        const item = MapItemJSON.createFromJSON(jsonItem);\r\n        if (item !== null) {\r\n          const mapItem = new itemMap[item.name](\r\n            item.position.x,\r\n            item.position.y\r\n          );\r\n          // 检测是否旋转\r\n          if (isRotatable(mapItem)) {\r\n            if (item.rotation !== undefined) {\r\n              mapItem.rotation = item.rotation;\r\n            } else {\r\n              return null;\r\n            }\r\n          }\r\n          // 检测是否放缩\r\n          if (isZoomable(mapItem)) {\r\n            if (item.zoom !== undefined) {\r\n              mapItem.zoomTo(mapItem.position, item.zoom);\r\n            } else {\r\n              return null;\r\n            }\r\n          }\r\n          items.push(mapItem);\r\n        } else {\r\n          return null;\r\n        }\r\n      }\r\n    }\r\n    // 检测是否发生碰撞\r\n    for (const from of items) {\r\n      for (const to of items) {\r\n        if (from.id !== to.id && from.crashDetect(to)) {\r\n          return null;\r\n        }\r\n      }\r\n    }\r\n    return items;\r\n  }\r\n\r\n  private collidesWithOthers(mapItem: MapItem): boolean {\r\n    for (const element of this.mapItems) {\r\n      if (element[0] !== mapItem.id && element[1].crashDetect(mapItem)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 处理元件添加,返回是否成功添加\r\n   * @param mapitem 添加的元件\r\n   */\r\n  public handleAddItem(mapitem: MapItem): boolean {\r\n    for (const i of this.mapItems) {\r\n      if (i[1].crashDetect(mapitem)) {\r\n        return false;\r\n      }\r\n    }\r\n    this.mapItems.set(mapitem.id, mapitem);\r\n    if (mapitem instanceof Ball) {\r\n      this.balls.set(mapitem.id, mapitem);\r\n    } else if (mapitem instanceof BaffleAlphaMapItem) {\r\n      this.alphaBaffles.set(mapitem.id, mapitem);\r\n    } else if (mapitem instanceof BaffleBetaMapItem) {\r\n      this.betaBaffles.set(mapitem.id, mapitem);\r\n    }\r\n    // this.currentFileModified = true;\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * 拖动元件的处理,返回是否成功拖动\r\n   * @param id 元件ID\r\n   * @param newPosition 新位置\r\n   */\r\n  public handleDraggingItem(id: number, newPosition: Vector2D): boolean {\r\n    const mapItem: MapItem | undefined = this.mapItems.get(id);\r\n    if (mapItem !== undefined) {\r\n      const oldPosition: Vector2D = mapItem.position;\r\n      mapItem.translate(newPosition);\r\n      if (this.collidesWithOthers(mapItem)) {\r\n        mapItem.translate(oldPosition);\r\n        return false;\r\n      }\r\n      // this.currentFileModified = true;\r\n      this.savedJSONString = this.mapItemsToJSON(this.mapItems);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 删除元件的处理,返回是否成功删除\r\n   * @param id 元件ID\r\n   */\r\n  public handleDeleteItem(id: number): boolean {\r\n    this.balls.delete(id);\r\n    this.alphaBaffles.delete(id);\r\n    this.betaBaffles.delete(id);\r\n    const result = this.mapItems.delete(id);\r\n    // if (result) this.currentFileModified = true;\r\n    this.savedJSONString = this.mapItemsToJSON(this.mapItems);\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * 吸收球处理\r\n   * @param id 球ID\r\n   */\r\n  public handleAbsorb(id: number): boolean {\r\n    const ball: MapItem | undefined = this.mapItems.get(id);\r\n    if (ball !== undefined && ball instanceof Ball) {\r\n      this.balls.delete(id);\r\n      this.mapItems.delete(id);\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 处理放大操作,返回是否成功放大\r\n   * @param id 元件ID\r\n   */\r\n  public handleZoomIn(id: number): boolean {\r\n    const mapItem: MapItem | undefined = this.mapItems.get(id);\r\n    if (mapItem !== undefined && isZoomable(mapItem)) {\r\n      const zoom: number = mapItem.zoom;\r\n      mapItem.zoomTo(mapItem.position, zoom + 1);\r\n      if (this.collidesWithOthers(mapItem)) {\r\n        mapItem.zoomTo(mapItem.position, zoom);\r\n        return false;\r\n      }\r\n      // this.currentFileModified = true;\r\n      this.savedJSONString = this.mapItemsToJSON(this.mapItems);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 处理缩小操作,返回是否成功缩小\r\n   * @param id 元件ID\r\n   */\r\n  public handleZoomOut(id: number): boolean {\r\n    const mapItem: MapItem | undefined = this.mapItems.get(id);\r\n    if (mapItem !== undefined && isZoomable(mapItem)) {\r\n      const zoom: number = mapItem.zoom;\r\n      if (zoom <= 1) {\r\n        return false;\r\n      }\r\n      mapItem.zoomTo(mapItem.position, zoom - 1);\r\n      if (this.collidesWithOthers(mapItem)) {\r\n        mapItem.zoomTo(mapItem.position, zoom);\r\n        return false;\r\n      }\r\n      // this.currentFileModified = true;\r\n      this.savedJSONString = this.mapItemsToJSON(this.mapItems);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 处理旋转操作,返回是否成功旋转\r\n   * @param id 元件ID\r\n   */\r\n  public handleRotate(id: number): boolean {\r\n    const mapItem: MapItem | undefined = this.mapItems.get(id);\r\n    if (mapItem !== undefined && isRotatable(mapItem)) {\r\n      mapItem.rotate(mapItem.center, Angle.RIGHT_ANGLE);\r\n      if (this.collidesWithOthers(mapItem)) {\r\n        mapItem.rotate(mapItem.center, Angle.RIGHT_ANGLE_REVERSE);\r\n        return false;\r\n      }\r\n      // this.currentFileModified = true;\r\n      this.savedJSONString = this.mapItemsToJSON(this.mapItems);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private state: \"LAYOUT\" | \"PAUSED\" | \"PLAYING\" = \"LAYOUT\";\r\n\r\n  /**\r\n   * 开始游玩模式\r\n   */\r\n  public startPlaying(): void {\r\n    this.state = \"PLAYING\";\r\n    for (const kv of this.balls) {\r\n      const ball: Ball = kv[1];\r\n      ball.massPoint.setAcceleration(\"gravity\", Physical.gravity);\r\n      ball.massPoint.setAcceleration(\"pipe\", new Vector2D(0, 0));\r\n      ball.massPoint.setAcceleration(\"centripetal\", new Vector2D(0, 0));\r\n    }\r\n    const timer: number = setInterval(() => {\r\n      switch (this.state) {\r\n        case \"PLAYING\":\r\n          for (const [, ball] of this.balls) {\r\n            ball.massPoint.tick();\r\n            ball.translate(\r\n              Vector2D.difference(ball.position, ball.center).add(\r\n                ball.massPoint.p\r\n              )\r\n            );\r\n            for (const [, item] of this.mapItems) {\r\n              if (item.id != ball.id) {\r\n                if (item.crashDetect(ball)) {\r\n                  item.crashHandle(ball);\r\n                }\r\n              }\r\n            }\r\n          }\r\n          break;\r\n        case \"PAUSED\":\r\n          break;\r\n        case \"LAYOUT\":\r\n          clearInterval(timer);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }, 1);\r\n  }\r\n\r\n  /**\r\n   * 停止游玩\r\n   */\r\n  public stopPlaying(): void {\r\n    // todo\r\n    this.state = \"LAYOUT\";\r\n    this.mapItems.clear();\r\n    this.mapItems.set(this.border.id, this.border);\r\n    // TODO: 从JSON读取\r\n    this.loadMapItemsFromJSON(this.savedJSONString);\r\n  }\r\n\r\n  public pause(): void {\r\n    this.state = \"PAUSED\";\r\n  }\r\n\r\n  public continue(): void {\r\n    this.state = \"PLAYING\";\r\n  }\r\n\r\n  /**\r\n   * 将mapItems转换为JSON格式string\r\n   */\r\n  private mapItemsToJSON(mapItems: Map<number, MapItem>): string {\r\n    const mapItemJSONs: MapItemJSON[] = [];\r\n    for (const [, item] of mapItems) {\r\n      const mapItem: MapItem = item;\r\n      const mapItemJSON: MapItemJSON = {\r\n        name: mapItem.name,\r\n        position: mapItem.position,\r\n        rotation: isRotatable(mapItem) ? mapItem.rotation : undefined,\r\n        zoom: isZoomable(mapItem) ? mapItem.zoom : undefined\r\n      };\r\n      mapItemJSONs.push(mapItemJSON);\r\n    }\r\n    return JSON.stringify(mapItemJSONs);\r\n  }\r\n\r\n  private clearAll() {\r\n    this.balls.clear();\r\n    this.alphaBaffles.clear();\r\n    this.betaBaffles.clear();\r\n    this.mapItems.clear();\r\n  }\r\n\r\n  public handleBaffleMove(name: MapItemNames, direction: \"left\" | \"right\") {\r\n    const movement: Vector2D = Vector2D.ZERO;\r\n    switch (direction) {\r\n      case \"left\":\r\n        movement.x = -5;\r\n        break;\r\n      case \"right\":\r\n        movement.x = 5;\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    switch (name) {\r\n      case \"baffle-alpha\":\r\n        for (const [, baffle] of this.alphaBaffles) {\r\n          baffle.move(movement);\r\n          if (this.collidesWithOthers(baffle)) {\r\n            baffle.move(Vector2D.negate(movement));\r\n          }\r\n        }\r\n        break;\r\n      case \"baffle-beta\":\r\n        for (const [, baffle] of this.betaBaffles) {\r\n          baffle.move(movement);\r\n          if (this.collidesWithOthers(baffle)) {\r\n            baffle.move(Vector2D.negate(movement));\r\n          }\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\nexport default Controller;\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue } from \"vue-property-decorator\";\r\nimport ItemImage from \"@/components/base/ItemImage.vue\";\r\nimport store from \"@/store/index\";\r\nimport { MapItem } from \"@/core/mapitems/map-item\";\r\nimport Controller from \"@/core/controller/Controller\";\r\nimport { isViewItem } from \"@/core/constants/gizmo\";\r\nimport { Vector2D } from \"@/core/physics\";\r\nimport { Gizmo } from \"@/core/constants/gizmo\";\r\n\r\n@Component({\r\n  components: {\r\n    ItemImage\r\n  }\r\n})\r\nexport default class GamePanel extends Vue {\r\n  $refs!: {\r\n    \"game-grid\": HTMLElement;\r\n  };\r\n\r\n  items: MapItem[] = [];\r\n\r\n  get currentItemId(): number {\r\n    if (\r\n      store.state.module1.currentMode === \"LAYOUT\" &&\r\n      store.state.module1.panelCurrentItem\r\n    ) {\r\n      return store.state.module1.panelCurrentItem.id;\r\n    } else {\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  private gridX!: number;\r\n  private gridY!: number;\r\n\r\n  mounted() {\r\n    const p = this.$refs[\"game-grid\"].getBoundingClientRect();\r\n    this.gridX = p.left;\r\n    this.gridY = p.top;\r\n    setInterval(() => {\r\n      this.items = Controller.getInstance().items;\r\n    }, 100);\r\n  }\r\n\r\n  /**\r\n   * 点击空白区域\r\n   */\r\n  onPanelClick() {\r\n    store.commit.changePanelCurrentItem(null);\r\n  }\r\n\r\n  /**\r\n   * 点击图片（item）\r\n   */\r\n  onImgClick(item: MapItem) {\r\n    const m = store.state.module1;\r\n    if (\r\n      m.toolZoneCurrentItem.typeValue === \"select\" &&\r\n      m.currentMode === \"LAYOUT\"\r\n    ) {\r\n      store.commit.changePanelCurrentItem(item);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 处理从组件栏拖动到网格上的dragover事件\r\n   */\r\n  onDragover(event: DragEvent) {\r\n    const item = store.state.module1.draggingItem;\r\n    if (event.dataTransfer) {\r\n      if (item === null) {\r\n        event.dataTransfer.dropEffect = \"none\";\r\n      } else if (isViewItem(item)) {\r\n        event.dataTransfer.dropEffect = \"copy\";\r\n      } else if (item instanceof MapItem) {\r\n        event.dataTransfer.dropEffect = \"move\";\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 处理从组件栏拖动到网格放下后的drop事件\r\n   */\r\n  onDrop(event: DragEvent) {\r\n    // console.log('You dropped something!');\r\n    const item = store.state.module1.draggingItem;\r\n    if (item === null) {\r\n      return;\r\n    }\r\n    const offset = store.state.module1.draggingItemOffset;\r\n    const position = new Vector2D(\r\n      event.clientX - this.gridX - offset.x,\r\n      event.clientY - this.gridY - offset.y\r\n    );\r\n    if (isViewItem(item) && item.typeValue !== \"select\") {\r\n      this.formatPosition(position, \"floor\");\r\n      const mapItem = Controller.getInstance().createMapItem(\r\n        item.typeValue,\r\n        position.x,\r\n        position.y\r\n      );\r\n      if (mapItem != null) {\r\n        store.commit.changePanelCurrentItem(mapItem);\r\n      }\r\n    } else if (item instanceof MapItem) {\r\n      this.formatPosition(position, \"round\");\r\n      Controller.getInstance().handleDraggingItem(item.id, position);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 确定实际所放的位置\r\n   */\r\n  private formatPosition(position: Vector2D, options: \"round\" | \"floor\") {\r\n    const cellLength = Gizmo.gridLength + Gizmo.gridLineLength;\r\n    if (options == \"round\") {\r\n      // 适用于从item zone拖放\r\n      position.x = Math.round(position.x / cellLength) * cellLength;\r\n      position.y = Math.round(position.y / cellLength) * cellLength;\r\n    } else {\r\n      // 适用于从game panel拖放\r\n      position.x = Math.floor(position.x / cellLength) * cellLength;\r\n      position.y = Math.floor(position.y / cellLength) * cellLength;\r\n    }\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GamePanel.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GamePanel.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./GamePanel.vue?vue&type=template&id=849369b8&scoped=true&\"\nimport script from \"./GamePanel.vue?vue&type=script&lang=ts&\"\nexport * from \"./GamePanel.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./GamePanel.vue?vue&type=style&index=0&id=849369b8&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"849369b8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"item-zone\",style:('pointer-events: ' + (_vm.currentMode == 'LAYOUT' ? 'auto' : 'none'))},[_c('table',{staticClass:\"item-table\",attrs:{\"width\":\"100%\"}},[_c('caption',{staticClass:\"caption\"},[_vm._v(\" 组件栏 \")]),_vm._l((_vm.itemss),function(items,rowIndex){return _c('tr',{key:rowIndex,staticClass:\"two-item\"},_vm._l((items),function(item,colIndex){return _c('td',{key:colIndex},[_c('label',{staticClass:\"item\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.currentItem),expression:\"currentItem\"}],attrs:{\"id\":'items' + (rowIndex * 4 + colIndex),\"type\":\"radio\",\"name\":\"chooseItem\"},domProps:{\"checked\":item.typeValue,\"value\":item.typeValue,\"checked\":_vm._q(_vm.currentItem,item.typeValue)},on:{\"change\":function($event){_vm.currentItem=item.typeValue}}}),_c('img',{attrs:{\"src\":item.img,\"draggable\":item.typeValue != 'select',\"height\":_vm.length,\"width\":_vm.length},on:{\"dragstart\":function($event){return _vm.onDragstart(item, $event)},\"dragend\":function($event){return _vm.onDragend(item, $event)}}})])])}),0)})],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\r\nimport store from \"@/store/index\";\r\nimport { ViewItem, Gizmo, ItemType } from \"@/core/constants/gizmo\";\r\nimport { itemMap } from \"@/core/constants\";\r\nimport { Vector2D } from \"@/core/physics\";\r\n@Component\r\nexport default class ItemZone extends Vue {\r\n  get currentMode() {\r\n    return store.state.module1.currentMode;\r\n  }\r\n\r\n  private length = 48;\r\n  private currentItem: ItemType = \"select\";\r\n\r\n  @Watch(\"currentItem\")\r\n  onCurrentItemChanged(val: ItemType, oldVal: ItemType) {\r\n    store.commit.changeToolZoneCurrentItem(Gizmo.getViewItemByType(val));\r\n  }\r\n\r\n  readonly itemss: ViewItem[][] = Gizmo.itemss;\r\n\r\n  onDragstart(item: ViewItem, event: DragEvent) {\r\n    store.commit.changeDraggingItemOffset(new Vector2D(0, 0));\r\n    store.commit.changeDraggingItem(item);\r\n  }\r\n\r\n  onDragend(item: ViewItem, event: DragEvent) {\r\n    store.commit.changeDraggingItem(null);\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemZone.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemZone.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ItemZone.vue?vue&type=template&id=3e798ab6&scoped=true&\"\nimport script from \"./ItemZone.vue?vue&type=script&lang=ts&\"\nexport * from \"./ItemZone.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ItemZone.vue?vue&type=style&index=0&id=3e798ab6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3e798ab6\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tool-zone\",style:('pointer-events: ' + (_vm.available ? 'auto' : 'none'))},[_c('table',{staticClass:\"tool-table\",attrs:{\"width\":\"100%\"}},[_c('caption',{staticClass:\"caption\"},[_vm._v(\" 工具栏 \")]),_c('tr',{staticClass:\"two-tool\"},[_c('td',[_c('img',{staticClass:\"tool\",attrs:{\"src\":\"img/tool/rotate.png\",\"height\":_vm.length,\"width\":_vm.length},on:{\"click\":_vm.rotate}})]),_c('td',[_c('img',{staticClass:\"tool\",attrs:{\"src\":\"img/tool/remove.png\",\"height\":_vm.length,\"width\":_vm.length},on:{\"click\":_vm.remove}})])]),_c('tr',[_c('td',[_c('img',{staticClass:\"tool\",attrs:{\"src\":\"img/tool/zoom-in.png\",\"height\":_vm.length,\"width\":_vm.length},on:{\"click\":_vm.zoomin}})]),_c('td',[_c('img',{staticClass:\"tool\",attrs:{\"src\":\"img/tool/zoom-out.png\",\"height\":_vm.length,\"width\":_vm.length},on:{\"click\":_vm.zoomout}})])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue } from \"vue-property-decorator\";\r\nimport store from \"@/store/index\";\r\nimport Controller from \"@/core/controller/Controller\";\r\nimport { MapItem } from \"@/core/mapitems/map-item\";\r\n\r\n@Component\r\nexport default class ToolZone extends Vue {\r\n  get available(): boolean {\r\n    const m = store.state.module1;\r\n    return m.currentMode === \"LAYOUT\" && m.panelCurrentItem != null;\r\n  }\r\n  length = 50;\r\n  get currentItem(): MapItem | null {\r\n    return store.state.module1.panelCurrentItem;\r\n  }\r\n  rotate() {\r\n    if (this.available && this.currentItem) {\r\n      Controller.getInstance().handleRotate(this.currentItem.id);\r\n    }\r\n  }\r\n  remove() {\r\n    if (this.available && this.currentItem) {\r\n      Controller.getInstance().handleDeleteItem(this.currentItem.id);\r\n    }\r\n  }\r\n  zoomin() {\r\n    if (this.available && this.currentItem) {\r\n      Controller.getInstance().handleZoomIn(this.currentItem.id);\r\n    }\r\n  }\r\n  zoomout() {\r\n    if (this.available && this.currentItem) {\r\n      Controller.getInstance().handleZoomOut(this.currentItem.id);\r\n    }\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ToolZone.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ToolZone.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ToolZone.vue?vue&type=template&id=08d92c8a&scoped=true&\"\nimport script from \"./ToolZone.vue?vue&type=script&lang=ts&\"\nexport * from \"./ToolZone.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ToolZone.vue?vue&type=style&index=0&id=08d92c8a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"08d92c8a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mode-zone\"},[_c('table',{staticClass:\"mode-table\",attrs:{\"width\":\"100%\"}},[_c('caption',{staticClass:\"caption\"},[_vm._v(\" 模式栏 \")]),_c('tr',[_c('td',{staticClass:\"mode-col\",attrs:{\"align\":\"right\"}},[(_vm.currentMode === 'LAYOUT')?_c('img',{attrs:{\"src\":\"img/mode/arrow.png\",\"height\":\"20\"}}):_vm._e()]),_c('td',{attrs:{\"align\":\"left\",\"colspan\":\"2\"}},[_c('button',{staticClass:\"layout-button\",on:{\"click\":_vm.changeToLayoutMode}},[_vm._v(\" 布局模式 \")])])]),_c('tr',[_c('td',{attrs:{\"align\":\"right\"}},[(_vm.currentMode === 'PLAY')?_c('img',{attrs:{\"src\":\"img/mode/arrow.png\",\"height\":\"20\"}}):_vm._e()]),_c('td',{attrs:{\"align\":\"left\"}},[_c('button',{staticClass:\"play-button\",on:{\"click\":_vm.changeToPlayMode}},[_vm._v(\" 游玩模式 \")])]),_c('td',[(_vm.currentMode === 'PLAY')?_c('img',{staticClass:\"controll-img\",attrs:{\"src\":_vm.controllImg,\"height\":\"30\",\"title\":\"咋瓦鲁多\"},on:{\"click\":_vm.changeState}}):_vm._e()])])]),_c('span',[_vm._v(\"GIZMO BALL\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport store from \"@/store/index\";\r\nimport Controller from \"@/core/controller/Controller\";\r\n@Component\r\nexport default class ModeZone extends Vue {\r\n  get currentMode() {\r\n    return store.state.module1.currentMode;\r\n  }\r\n\r\n  get controllImg(): string {\r\n    if (store.state.module1.currentState === \"PLAYING\") {\r\n      return \"img/mode/pause.png\";\r\n    } else {\r\n      return \"img/mode/continue.png\";\r\n    }\r\n  }\r\n\r\n  private changeState() {\r\n    if (store.state.module1.currentState === \"PLAYING\") {\r\n      store.commit.changeState(\"PAUSE\");\r\n      Controller.getInstance().pause();\r\n    } else {\r\n      store.commit.changeState(\"PLAYING\");\r\n      Controller.getInstance().continue();\r\n    }\r\n  }\r\n\r\n  private changeToLayoutMode() {\r\n    if (this.currentMode === \"LAYOUT\") return;\r\n    store.commit.changeMode(\"LAYOUT\");\r\n    store.commit.changeState(\"PAUSE\");\r\n    Controller.getInstance().stopPlaying();\r\n  }\r\n\r\n  private changeToPlayMode() {\r\n    if (this.currentMode === \"PLAY\") return;\r\n    store.commit.changeMode(\"PLAY\");\r\n    store.commit.changeState(\"PLAYING\");\r\n    Controller.getInstance().startPlaying();\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModeZone.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModeZone.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ModeZone.vue?vue&type=template&id=180a421e&scoped=true&\"\nimport script from \"./ModeZone.vue?vue&type=script&lang=ts&\"\nexport * from \"./ModeZone.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ModeZone.vue?vue&type=style&index=0&id=180a421e&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"180a421e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',{attrs:{\"id\":\"gizmo-ball\"}},[_vm._v(\"Gizmo Ball\")]),_c('blockquote',[_vm._v(\" 这是一个简单的弹球游戏。是electron桌面版砍掉了文件保存布局和加载布局的功能的阉割版。 \")]),_c('h2',{attrs:{\"id\":\"操作说明\"}},[_vm._v(\"操作说明\")]),_c('h3',{attrs:{\"id\":\"布局模式\"}},[_vm._v(\"布局模式\")]),_c('ol',[_c('li',[_vm._v(\" 在选中“选择组件”（图标为手）的状态下，可以选择、拖动网格中的玩具布局。 \")]),_c('li',[_vm._v(\" 在选中网格中的一个组件实例时，可以通过工具栏调整选中的组件的旋转方向以及大小，也可以点X删除组件。 \")]),_c('li',[_vm._v(\" 选中其他组件没有什么意义……（本来是想做点击放置物品的，后来改成拖动就没用了） \")]),_c('li',[_vm._v(\" 最下面两个组件分别是左挡板和右挡板，区别是控制的按键不一样。他们不可以旋转或者改变大小。 \")]),_c('li',[_c('strong',[_vm._v(\"小球可以放多个，但是放太多可能会很卡（问就是优化的还不够）。\")])])]),_c('h3',{attrs:{\"id\":\"游玩模式\"}},[_vm._v(\"游玩模式\")]),_c('ul',[_c('li',[_vm._v(\"按键盘A/D可以左右移动左挡板，按键盘J/L移动右挡板。\")]),_c('li',[_vm._v(\"按蓝色的三角形发动\"),_c('code',[_vm._v(\"砸瓦鲁多\")]),_vm._v(\"。\")]),_c('li',[_vm._v(\"剩下的也就只有看小球乱弹了……\")])])])}]\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./Instruction.vue?vue&type=template&id=4a5f8f2e&scoped=true&\"\nvar script = {}\nimport style0 from \"./Instruction.vue?vue&type=style&index=0&id=4a5f8f2e&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4a5f8f2e\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport GamePanel from \"@/components/modules/GamePanel.vue\";\r\nimport ItemZone from \"@/components/modules/ItemZone.vue\";\r\nimport ToolZone from \"@/components/modules/ToolZone.vue\";\r\nimport ModeZone from \"@/components/modules/ModeZone.vue\";\r\nimport Instruction from \"@/components/modules/instruction/Instruction.vue\";\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\n\r\n@Component({\r\n  components: {\r\n    GamePanel,\r\n    ItemZone,\r\n    ToolZone,\r\n    ModeZone,\r\n    Instruction,\r\n  }\r\n})\r\nexport default class Home extends Vue {\r\n  @Prop() private msg!: string;\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Home.vue?vue&type=template&id=53f68fe2&scoped=true&\"\nimport script from \"./Home.vue?vue&type=script&lang=ts&\"\nexport * from \"./Home.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Home.vue?vue&type=style&index=0&id=53f68fe2&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"53f68fe2\",\n  null\n  \n)\n\nexport default component.exports","import Controller from \"@/core/controller/Controller\";\r\nimport { MapItemNames } from \"@/core/enums\";\r\n\r\nclass TSViews {\r\n  public static keyMap: Map<string, boolean> = new Map<string, boolean>([\r\n    [\"a\", false],\r\n    [\"d\", false],\r\n    [\"j\", false],\r\n    [\"l\", false]\r\n  ]);\r\n\r\n  /**\r\n   * 绑定按键\r\n   */\r\n  public static bindKey() {\r\n    window.onkeydown = (e: KeyboardEvent) => {\r\n      const k = e.key;\r\n      if (this.keyMap.has(k)) {\r\n        this.keyMap.set(k, true);\r\n      }\r\n    };\r\n    window.onkeyup = (e: KeyboardEvent) => {\r\n      const k = e.key;\r\n      if (this.keyMap.has(k)) {\r\n        this.keyMap.set(k, false);\r\n      }\r\n    };\r\n    const controller = Controller.getInstance();\r\n\r\n    setInterval(() => {\r\n      if (this.keyMap.get(\"a\")) {\r\n        controller.handleBaffleMove(\"baffle-alpha\", \"left\");\r\n      }\r\n      if (this.keyMap.get(\"d\")) {\r\n        controller.handleBaffleMove(\"baffle-alpha\", \"right\");\r\n      }\r\n      if (this.keyMap.get(\"l\")) {\r\n        controller.handleBaffleMove(\"baffle-beta\", \"right\");\r\n      }\r\n      if (this.keyMap.get(\"j\")) {\r\n        controller.handleBaffleMove(\"baffle-beta\", \"left\");\r\n      }\r\n    }, 10);\r\n  }\r\n}\r\n\r\nexport default TSViews;\r\n","\n\n\n\n\n\n\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\nimport Home from \"@/views/Home.vue\";\nimport TSViews from \"@/views/TSViews\";\n\n@Component({\n  components: {\n    Home\n  }\n})\nexport default class HelloWorld extends Vue {\n  $refs!: {\n    app: HTMLElement;\n  };\n\n  mounted() {\n    // this.setAppSize();\n    TSViews.bindKey();\n  }\n\n  private setAppSize() {\n    this.$refs.app.style.height = `${window.innerHeight - 30}px`;\n    this.$refs.app.style.width = `${window.innerWidth}px`;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=4c22a492&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from \"vue\";\r\nimport App from \"./App.vue\";\r\nimport store from \"./store\";\r\n\r\nVue.config.productionTip = false;\r\n\r\nnew Vue({\r\n  store: store as any,\r\n  render: h => h(App)\r\n}).$mount(\"#app\");\r\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GamePanel.vue?vue&type=style&index=0&id=849369b8&scoped=true&lang=css&\""],"sourceRoot":""}